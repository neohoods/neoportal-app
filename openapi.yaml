openapi: 3.0.1
info:
  title: portal NeoHoods API
  version: "2.0"
  description: |
    # Summary
    portal NeoHoods API

servers:
  - url: https://portal.neohoods.com
    description: portal neohoods API

paths:
  /public/auth/login:
    post:
      operationId: login
      summary: Log user with username / password
      tags:
        - auth-api

      security:
        - BearerAuthOAuth: []

      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  example: "my-login"
                password:
                  type: string
                  example: "my-password"
              required:
                - username
                - password

      responses:
        "200":
          $ref: "#/components/responses/OK_200_LOGIN"

  /public/auth/signup:
    post:
      operationId: signUp
      summary: Register a new user
      tags:
        - auth-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                username:
                  type: string
                  example: "newuser"
                firstName:
                  type: string
                  example: "John"
                lastName:
                  type: string
                  example: "Doe"
                email:
                  type: string
                  example: "newuser@example.com"
                type:
                  $ref: "#/components/schemas/UserType"
                password:
                  type: string
                  example: "securepassword"

              required:
                - username
                - firstName
                - lastName
                - email
                - type
                - password
      responses:
        "201":
          description: User registered successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SignUp201Response"
        "400":
          $ref: "#/components/responses/BadRequest"

  /public/auth/signout:
    post:
      operationId: signOut
      summary: Sign out the current user
      tags:
        - auth-api
      responses:
        "204":
          description: User signed out successfully

  /public/auth/reset-password:
    post:
      operationId: resetPassword
      summary: Reset password for a user
      tags:
        - auth-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  example: "user@example.com"
              required:
                - email
      responses:
        "200":
          description: Password reset email sent
        "404":
          $ref: "#/components/responses/NotFound"

  /public/auth/reset-password/confirm:
    post:
      operationId: confirmResetPassword
      summary: Confirm password reset with token
      tags:
        - auth-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                token:
                  type: string
                  example: "reset-token-123"
                newPassword:
                  type: string
                  example: "newSecurePassword"
              required:
                - token
                - newPassword
      responses:
        "200":
          description: Password reset successfully
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  /public/auth/email-verification:
    post:
      operationId: verifyEmail
      summary: Verify user's email with token
      tags:
        - auth-api
      parameters:
        - name: token
          in: query
          description: Email verification token
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Email verification response
          content:
            application/json:
              schema:
                type: object
                required:
                  - success
                  - message
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Email verified successfully"
        "400":
          $ref: "#/components/responses/BadRequest"

  /hub/hello-world:
    get:
      operationId: getHelloWorld
      summary: hello world
      tags:
        - hello-world-api

      security:
        - BearerAuthOAuth: []

      responses:
        "200":
          $ref: "#/components/responses/OK_200_GET_HELLO_WORLD"

  /hub/profile:
    get:
      operationId: getProfile
      summary: Get the current user's profile
      tags:
        - profile-hub-api
      responses:
        "200":
          description: get profile retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "404":
          description: User not found
    put:
      operationId: updateProfile
      summary: Update the current user's profile
      tags:
        - profile-hub-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/User"
      responses:
        "200":
          description: User profile updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
        "400":
          description: Invalid input
        "404":
          description: User not found

  /hub/users:
    get:
      operationId: getHubUsers
      summary: Retrieve all users (for hub users)
      tags:
        - users-hub-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: A list of users (basic information only)
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/UserBasic"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /hub/announcements:
    post:
      operationId: createAnnouncement
      summary: Create a new announcement
      tags:
        - announcements-hub-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                  example: "New Announcement"
                content:
                  type: string
                  example: "This is the content of the announcement."
                category:
                  $ref: "#/components/schemas/AnnouncementCategory"
              required:
                - title
                - content
                - category
      responses:
        "201":
          description: Announcement created successfully

    get:
      operationId: getAnnouncements
      summary: Retrieve all announcements
      tags:
        - announcements-hub-api
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          required: false
          schema:
            type: integer
            default: 0
        - name: pageSize
          in: query
          description: Number of announcements per page
          required: false
          schema:
            type: integer
            default: 10
      responses:
        "200":
          description: A paginated list of announcements
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedAnnouncementsResponse"

  /hub/announcements/{announcement-id}:
    parameters:
      - name: announcement-id
        in: path
        description: Announcement ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getAnnouncement
      summary: Retrieve a specific announcement by ID
      tags:
        - announcements-hub-api
      responses:
        "200":
          description: A single announcement
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Announcement"

    put:
      operationId: updateAnnouncement
      summary: Update an existing announcement
      tags:
        - announcements-hub-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                title:
                  type: string
                  example: "Updated Announcement"
                content:
                  type: string
                  example: "This is the updated content of the announcement."
              required:
                - title
                - content
      responses:
        "200":
          description: Announcement updated successfully

    delete:
      operationId: deleteAnnouncement
      summary: Delete an announcement
      tags:
        - announcements-hub-api
      responses:
        "204":
          description: Announcement deleted successfully

  /hub/infos:
    put:
      operationId: updateInfos
      summary: Update infos
      tags:
        - infos-hub-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Info"
      responses:
        "200":
          description: Infos updated successfully

    get:
      operationId: getInfos
      summary: Retrieve all infos
      tags:
        - infos-hub-api
      responses:
        "200":
          description: A list of infos
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Info"

  /hub/applications:
    post:
      operationId: createApplication
      summary: Create a new application
      tags:
        - applications-hub-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Application"
      responses:
        "201":
          description: App created successfully

    get:
      operationId: getApplications
      summary: Retrieve all applications
      tags:
        - applications-hub-api
      responses:
        "200":
          description: A list of applications
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Application"

  /hub/applications/{application-id}:
    parameters:
      - name: application-id
        in: path
        description: Application ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getApplication
      summary: Retrieve a specific application by ID
      tags:
        - applications-hub-api
      responses:
        "200":
          description: A single application
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Application"

    put:
      operationId: updateApplication
      summary: Update an existing application
      tags:
        - applications-hub-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Application"
      responses:
        "200":
          description: Application updated successfully

    delete:
      operationId: deleteApplication
      summary: Delete an application
      tags:
        - applications-hub-api
      responses:
        "204":
          description: Application deleted successfully

  /hub/units:
    get:
      operationId: getUnits
      summary: List units for current user
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: List of units
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Unit"

  /hub/units/directory:
    get:
      operationId: getUnitsDirectory
      summary: Get paginated directory of units with filters
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      parameters:
        - name: page
          in: query
          description: Page number (0-indexed)
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Page size
          schema:
            type: integer
            default: 20
        - name: type
          in: query
          description: Filter by unit type
          schema:
            $ref: "#/components/schemas/UnitType"
        - name: search
          in: query
          description: Search by unit name
          schema:
            type: string
        - name: userId
          in: query
          description: Filter by user membership
          schema:
            type: string
            format: uuid
        - name: onlyOccupied
          in: query
          description: Filter to show only units with at least one member
          schema:
            type: boolean
            default: false
      responses:
        "200":
          description: Paginated list of units
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedUnits"

  /hub/units/{unit-id}:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getUnit
      summary: Get unit details
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: Unit details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Unit"
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/units/{unit-id}/reservations:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getUnitReservations
      summary: Get reservations for a unit
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      parameters:
        - name: page
          in: query
          description: Page number (0-indexed)
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Page size
          schema:
            type: integer
            default: 20
      responses:
        "200":
          description: Paginated list of reservations for the unit
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedReservations"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/units/{unit-id}/calendar.ics:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getUnitCalendar
      summary: Get ICS calendar for unit reservations
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: ICS calendar file
          content:
            text/calendar:
              schema:
                type: string
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/units/{unit-id}/invite:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: inviteUser
      summary: Invite user to unit
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/InviteUserRequest"
      responses:
        "200":
          description: Invitation created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnitInvitation"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/units/{unit-id}/members/{user-id}/approve:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
      - name: user-id
        in: path
        description: User ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: approveInvitation
      summary: Approve pending invitation
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: Invitation approved
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnitMember"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/units/{unit-id}/members/{user-id}/revoke:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
      - name: user-id
        in: path
        description: User ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: revokeMember
      summary: Remove member from unit
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      responses:
        "204":
          description: Member removed
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/units/{unit-id}/members/{user-id}/promote-admin:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
      - name: user-id
        in: path
        description: User ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: promoteAdmin
      summary: Promote member to admin
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: Member promoted to admin
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnitMember"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/units/{unit-id}/members/{user-id}/demote-admin:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
      - name: user-id
        in: path
        description: User ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: demoteAdmin
      summary: Remove admin rights from member
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: Admin rights removed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnitMember"
        "400":
          $ref: "#/components/responses/BadRequest"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/units/users/{user-id}/related-parking-garages:
    parameters:
      - name: user-id
        in: path
        description: User ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getRelatedParkingGarages
      summary: Get related parking and garages for a user
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: List of related parking and garage units
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Unit"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/units/invitations/{invitation-id}/accept:
    parameters:
      - name: invitation-id
        in: path
        description: Invitation ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: acceptInvitation
      summary: Accept invitation
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: Invitation accepted
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnitMember"
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/units/invitations/{invitation-id}/reject:
    parameters:
      - name: invitation-id
        in: path
        description: Invitation ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: rejectInvitation
      summary: Reject invitation
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      responses:
        "204":
          description: Invitation rejected
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/units/{unit-id}/join-request:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: createJoinRequest
      summary: Create a join request for a unit
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      requestBody:
        required: false
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateJoinRequestRequest"
      responses:
        "200":
          description: Join request created (or user added directly if unit is empty)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnitJoinRequest"
        "400":
          $ref: "#/components/responses/BadRequest"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/units/{unit-id}/join-requests:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getJoinRequests
      summary: Get pending join requests for a unit (admin only)
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: List of pending join requests
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/UnitJoinRequest"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/units/join-requests/{request-id}/approve:
    parameters:
      - name: request-id
        in: path
        description: Join request ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: approveJoinRequest
      summary: Approve a join request (admin of unit only)
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: Join request approved
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnitMember"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/units/join-requests/{request-id}/reject:
    parameters:
      - name: request-id
        in: path
        description: Join request ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: rejectJoinRequest
      summary: Reject a join request (admin of unit only)
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      responses:
        "204":
          description: Join request rejected
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/units/my-join-requests:
    get:
      operationId: getMyJoinRequests
      summary: Get pending join requests for the current user
      tags:
        - units-hub-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: List of pending join requests for the current user
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/UnitJoinRequest"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/units/join-requests:
    get:
      operationId: getAllJoinRequests
      summary: Get all pending join requests (admin global only)
      tags:
        - units-admin-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: List of all pending join requests
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/UnitJoinRequest"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/units/join-requests/{request-id}/approve:
    parameters:
      - name: request-id
        in: path
        description: Join request ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: approveJoinRequestAdmin
      summary: Approve a join request (admin global can approve any request)
      tags:
        - units-admin-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: Join request approved
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnitMember"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/units/join-requests/{request-id}/reject:
    parameters:
      - name: request-id
        in: path
        description: Join request ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: rejectJoinRequestAdmin
      summary: Reject a join request (admin global can reject any request)
      tags:
        - units-admin-api
      security:
        - BearerAuthOAuth: []
      responses:
        "204":
          description: Join request rejected
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /hub/custom-pages/:
    get:
      operationId: getCustomPageRefs
      summary: Retrieve all custom page references
      tags:
        - custom-pages-hub-api
      responses:
        "200":
          description: A list of custom page references with position and title
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    ref:
                      type: string
                    position:
                      type: string
                      enum: ["footer-links", "copyright", "footer-help"]
                    title:
                      type: string

  /hub/custom-pages/{page-ref}:
    parameters:
      - name: page-ref
        in: path
        description: Reference of the custom page
        required: true
        schema:
          type: string
    get:
      operationId: getCustomPage
      summary: Retrieve a custom page by reference
      tags:
        - custom-pages-hub-api
      responses:
        "200":
          description: A single custom page
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CustomPage"
        "404":
          description: Custom page not found

  /admin/custom-pages:
    get:
      operationId: getAdminCustomPages
      summary: Retrieve all custom pages
      tags:
        - custom-pages-admin-api
      responses:
        "200":
          description: A list of custom pages
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/CustomPage"

    post:
      operationId: createCustomPage
      summary: Create a new custom page
      tags:
        - custom-pages-admin-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CustomPage"
      responses:
        "201":
          description: Custom page created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CustomPage"

  /admin/custom-pages/{page-ref}:
    parameters:
      - name: page-ref
        in: path
        description: Reference of the custom page
        required: true
        schema:
          type: string
    get:
      operationId: getAdminCustomPage
      summary: Retrieve a specific custom page by reference
      tags:
        - custom-pages-admin-api
      responses:
        "200":
          description: A single custom page
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CustomPage"
        "404":
          description: Custom page not found

    put:
      operationId: updateCustomPage
      summary: Update a custom page
      tags:
        - custom-pages-admin-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CustomPage"
      responses:
        "200":
          description: Custom page updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CustomPage"
        "404":
          description: Custom page not found

    delete:
      operationId: deleteCustomPage
      summary: Delete a custom page
      tags:
        - custom-pages-admin-api
      responses:
        "204":
          description: Custom page deleted successfully
        "404":
          description: Custom page not found

  /admin/units:
    get:
      operationId: getAdminUnits
      summary: List all units
      tags:
        - units-admin-api
      security:
        - BearerAuthOAuth: []
      parameters:
        - name: page
          in: query
          description: Page number (0-indexed)
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          description: Page size
          schema:
            type: integer
            default: 20
        - name: search
          in: query
          description: Search by unit name
          schema:
            type: string
      responses:
        "200":
          description: Paginated list of units
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedUnits"
    post:
      operationId: createUnit
      summary: Create unit
      tags:
        - units-admin-api
      security:
        - BearerAuthOAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UnitRequest"
      responses:
        "201":
          description: Unit created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Unit"

  /admin/units/{unit-id}:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getAdminUnit
      summary: Get unit details
      tags:
        - units-admin-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: Unit details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Unit"
        "404":
          $ref: "#/components/responses/NotFound"
    put:
      operationId: updateUnit
      summary: Update unit
      tags:
        - units-admin-api
      security:
        - BearerAuthOAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UnitRequest"
      responses:
        "200":
          description: Unit updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Unit"
        "404":
          $ref: "#/components/responses/NotFound"
    delete:
      operationId: deleteUnit
      summary: Delete unit
      tags:
        - units-admin-api
      security:
        - BearerAuthOAuth: []
      responses:
        "204":
          description: Unit deleted
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/units/{unit-id}/members:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: addMember
      summary: Add member to unit
      tags:
        - units-admin-api
      security:
        - BearerAuthOAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/InviteUserRequest"
      responses:
        "200":
          description: Member added
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnitMember"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/units/{unit-id}/members/{user-id}/revoke:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
      - name: user-id
        in: path
        description: User ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: revokeAdminMember
      summary: Remove member from unit
      tags:
        - units-admin-api
      security:
        - BearerAuthOAuth: []
      responses:
        "204":
          description: Member removed
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/units/{unit-id}/members/{user-id}/promote-admin:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
      - name: user-id
        in: path
        description: User ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: promoteAdminMember
      summary: Promote member to admin
      tags:
        - units-admin-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: Member promoted to admin
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnitMember"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/units/{unit-id}/members/{user-id}/demote-admin:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
      - name: user-id
        in: path
        description: User ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: demoteAdminMember
      summary: Remove admin rights from member
      tags:
        - units-admin-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: Admin rights removed
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnitMember"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/units/{unit-id}/members/{user-id}/set-primary:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
      - name: user-id
        in: path
        description: User ID
        required: true
        schema:
          type: string
          format: uuid
    put:
      operationId: setPrimaryUnitForMember
      summary: Set this unit as the primary unit for the user
      tags:
        - units-admin-api
      security:
        - BearerAuthOAuth: []
      responses:
        "204":
          description: Primary unit set successfully
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/units/{unit-id}/members/{user-id}/residence-role:
    parameters:
      - name: unit-id
        in: path
        description: Unit ID
        required: true
        schema:
          type: string
          format: uuid
      - name: user-id
        in: path
        description: User ID
        required: true
        schema:
          type: string
          format: uuid
    put:
      operationId: updateMemberResidenceRole
      summary: Update member residence role
      tags:
        - units-admin-api
      security:
        - BearerAuthOAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdateMemberResidenceRoleRequest"
      responses:
        "200":
          description: Member residence role updated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UnitMember"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/help/categories:
    get:
      operationId: getAdminHelpCategories
      summary: Retrieve all help categories
      tags:
        - help-admin-api
      responses:
        "200":
          description: A list of help categories
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/HelpCategory"
    post:
      operationId: createHelpCategory
      summary: Create a new help category
      tags:
        - help-admin-api
      requestBody:
        description: The category to create
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/HelpCategory"
      responses:
        "201":
          description: Help category created successfully
    delete:
      operationId: deleteHelpCategory
      summary: Delete a help category
      tags:
        - help-admin-api
      parameters:
        - name: categoryId
          in: query
          description: The ID of the category to delete
          required: true
          schema:
            type: string
      responses:
        "204":
          description: Help category deleted successfully
    put:
      operationId: updateHelpCategory
      summary: Update a help category
      tags:
        - help-admin-api
      parameters:
        - name: categoryId
          in: query
          description: The ID of the category to update
          required: true
          schema:
            type: string
      requestBody:
        description: The updated category data
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/HelpCategory"
      responses:
        "200":
          description: Help category updated successfully

  /admin/help/articles:
    get:
      operationId: getAdminHelpArticles
      summary: Retrieve help articles by category ID
      tags:
        - help-admin-api
      parameters:
        - name: categoryId
          in: query
          description: The ID of the category to filter articles
          required: true
          schema:
            type: string
      responses:
        "200":
          description: A list of help articles
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/HelpArticle"
    post:
      operationId: createHelpArticle
      summary: Create a new help article
      tags:
        - help-admin-api
      requestBody:
        description: The article to create
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/HelpArticle"
      responses:
        "201":
          description: Help article created successfully
    delete:
      operationId: deleteHelpArticle
      summary: Delete a help article
      tags:
        - help-admin-api
      parameters:
        - name: articleId
          in: query
          description: The ID of the article to delete
          required: true
          schema:
            type: string
      responses:
        "204":
          description: Help article deleted successfully
    put:
      operationId: updateHelpArticle
      summary: Update a help article
      tags:
        - help-admin-api
      parameters:
        - name: articleId
          in: query
          description: The ID of the article to update
          required: true
          schema:
            type: string
      requestBody:
        description: The updated article data
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/HelpArticle"
      responses:
        "200":
          description: Help article updated successfully

  /hub/help/categories:
    get:
      operationId: getHelpCategories
      summary: Retrieve all help categories
      tags:
        - help-api
      responses:
        "200":
          description: A list of help categories
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/HelpCategory"

  /hub/help/articles:
    get:
      operationId: getHelpArticles
      summary: Retrieve help articles by category ID
      tags:
        - help-api
      parameters:
        - name: categoryId
          in: query
          description: The ID of the category to filter articles
          required: true
          schema:
            type: string
      responses:
        "200":
          description: A list of help articles
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/HelpArticle"

  /admin/users/batch:
    post:
      operationId: getUsersByIds
      summary: Retrieve multiple users by their IDs
      tags:
        - users-admin-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                userIds:
                  type: array
                  items:
                    type: string
                    format: uuid
              required:
                - userIds
      responses:
        "200":
          description: A list of users
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/User"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"
  /admin/users:
    get:
      operationId: getUsers
      summary: Retrieve all users
      tags:
        - users-admin-api
      responses:
        "200":
          description: A list of users
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/User"
    post:
      operationId: saveUser
      summary: Save a user
      tags:
        - users-admin-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/User"
      responses:
        "201":
          description: User saved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"

  /admin/users/{user-id}:
    parameters:
      - name: user-id
        in: path
        description: User ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getUser
      summary: Retrieve a specific user by ID
      tags:
        - users-admin-api
      responses:
        "200":
          description: A single user
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/User"
    delete:
      operationId: deleteUser
      summary: Delete a user
      tags:
        - users-admin-api
      responses:
        "204":
          description: User deleted successfully
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/users/{user-id}/password:
    parameters:
      - name: user-id
        in: path
        description: User ID
        required: true
        schema:
          type: string
          format: uuid
    put:
      operationId: setUserPassword
      summary: Set a user's password
      tags:
        - users-admin-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                newPassword:
                  type: string
                  example: "newSecurePassword"
              required:
                - newPassword
      responses:
        "204":
          description: Password updated successfully

  /admin/settings/security:
    get:
      operationId: getSecuritySettings
      summary: Retrieve security settings
      tags:
        - settings-admin-api
      responses:
        "200":
          description: Security settings retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  isRegistrationEnabled:
                    type: boolean
                    example: true
                  ssoEnabled:
                    type: boolean
                    example: false
                  ssoClientId:
                    type: string
                    example: "my-client-id"
                  ssoClientSecret:
                    type: string
                    example: "my-client-secret"
                  ssoTokenEndpoint:
                    type: string
                    example: "https://openid.example.com/token"
                  ssoAuthorizationEndpoint:
                    type: string
                    example: "https://openid.example.com/authorize"
                  ssoScope:
                    type: string
                    example: "openid profile email"
    post:
      operationId: saveSecuritySettings
      summary: Save security settings
      tags:
        - settings-admin-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                isRegistrationEnabled:
                  type: boolean
                  example: false
                ssoEnabled:
                  type: boolean
                  example: false
                ssoClientId:
                  type: string
                  example: "my-client-id"
                ssoClientSecret:
                  type: string
                  example: "my-client-secret"
                ssoTokenEndpoint:
                  type: string
                  example: "https://openid.example.com/token"
                ssoAuthorizationEndpoint:
                  type: string
                  example: "https://openid.example.com/authorize"
                ssoScope:
                  type: string
                  example: "openid profile email"
      responses:
        "200":
          description: Security settings saved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  isRegistrationEnabled:
                    type: boolean
                    example: false
                  ssoEnabled:
                    type: boolean
                    example: false
                  ssoClientId:
                    type: string
                    example: "my-client-id"
                  ssoClientSecret:
                    type: string
                    example: "my-client-secret"
                  ssoTokenEndpoint:
                    type: string
                    example: "https://openid.example.com/token"
                  ssoAuthorizationEndpoint:
                    type: string
                    example: "https://openid.example.com/authorize"
                  ssoScope:
                    type: string
                    example: "openid profile email"

  /admin/settings/spaces:
    get:
      operationId: getSpaceSettings
      summary: Retrieve space settings
      tags:
        - space-settings-admin-api
      responses:
        "200":
          description: Space settings retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PlatformFeeSettings"
    post:
      operationId: saveSpaceSettings
      summary: Save space settings
      tags:
        - space-settings-admin-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PlatformFeeSettings"
      responses:
        "200":
          description: Space settings saved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PlatformFeeSettings"

  /public/settings:
    get:
      operationId: getPublicSettings
      summary: Retrieve public UI settings
      tags:
        - settings-public-api
      responses:
        "200":
          description: Public UI settings retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  isRegistrationEnabled:
                    type: boolean
                    example: true
                  ssoEnabled:
                    type: boolean
                    example: false

  /public/sso/login-url:
    post:
      operationId: generateSSOLoginUrl
      summary: Generate the SSO login URL
      tags:
        - sso-public-api
      responses:
        "200":
          description: SSO login URL generated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  loginUrl:
                    type: string
                    example: true

  /public/sso/token-exchange:
    post:
      operationId: exchangeSSOToken
      summary: Exchange the SSO token for a JWT token
      tags:
        - sso-public-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                state:
                  type: string
                authorizationCode:
                  type: string
              required:
                - state
                - authorizationCode
      responses:
        "200":
          description: SSO token exchanged successfully

  /debug/notifications:
    post:
      operationId: debugPostNotification
      summary: Debug endpoint to create a notification for a specific user
      tags:
        - debug-api
      security:
        - BearerAuthOAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
                - notification
              properties:
                locale:
                  type: string
                  example: "en"
                  description: The locale of the notification
                userId:
                  type: string
                  format: uuid
                  description: The ID of the user to send the notification to
                notification:
                  $ref: "#/components/schemas/Notification"
                  description: The notification to send
      responses:
        "201":
          description: Notification created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Notification"
        "404":
          description: User not found
        "400":
          description: Invalid notification payload

  /hub/notifications:
    get:
      operationId: getNotifications
      summary: Retrieve all notifications
      tags:
        - notifications-hub-api
      responses:
        "200":
          description: A list of notifications
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Notification"

  /hub/notifications/unread-count:
    get:
      operationId: getUnreadNotificationsCount
      summary: Retrieve the count of unread notifications
      tags:
        - notifications-hub-api
      responses:
        "200":
          description: Count of unread notifications
          content:
            application/json:
              schema:
                type: object
                properties:
                  count:
                    type: integer
                    example: 5

  /hub/notifications/acknowledge:
    post:
      operationId: acknowledgeNotifications
      summary: Acknowledge notifications as read
      tags:
        - notifications-hub-api
      requestBody:
        description: List of notifications to acknowledge
        required: true
        content:
          application/json:
            schema:
              type: array
              items:
                $ref: "#/components/schemas/Notification"
      responses:
        "204":
          description: Notifications acknowledged successfully

  /hub/notifications-settings:
    get:
      operationId: getNotificationSettings
      summary: Get the current user's notification settings
      tags:
        - notifications-hub-api
      responses:
        "200":
          description: Notification settings retrieved successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NotificationSettings"
        "401":
          description: Unauthorized
    put:
      operationId: updateNotificationSettings
      summary: Update the current user's notification settings
      tags:
        - notifications-hub-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/NotificationSettings"
      responses:
        "200":
          description: Notification settings updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NotificationSettings"
        "400":
          description: Invalid input
        "401":
          description: Unauthorized

  /admin/newsletters:
    get:
      operationId: getNewsletters
      summary: Retrieve all newsletters
      tags:
        - newsletters-admin-api
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          required: false
          schema:
            type: integer
            default: 0
        - name: pageSize
          in: query
          description: Number of newsletters per page
          required: false
          schema:
            type: integer
            default: 10
        - name: status
          in: query
          description: Filter by newsletter status
          required: false
          schema:
            $ref: "#/components/schemas/NewsletterStatus"
      responses:
        "200":
          description: A paginated list of newsletters
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedNewslettersResponse"
    post:
      operationId: createNewsletter
      summary: Create a new newsletter
      tags:
        - newsletters-admin-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/NewsletterRequest"
      responses:
        "201":
          description: Newsletter created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Newsletter"
        "400":
          $ref: "#/components/responses/BadRequest"

  /admin/newsletters/{newsletter-id}:
    parameters:
      - name: newsletter-id
        in: path
        description: Newsletter ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getNewsletter
      summary: Retrieve a specific newsletter by ID
      tags:
        - newsletters-admin-api
      responses:
        "200":
          description: A single newsletter
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Newsletter"
        "404":
          $ref: "#/components/responses/NotFound"
    put:
      operationId: updateNewsletter
      summary: Update an existing newsletter
      tags:
        - newsletters-admin-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/NewsletterRequest"
      responses:
        "200":
          description: Newsletter updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Newsletter"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"
    delete:
      operationId: deleteNewsletter
      summary: Delete a newsletter
      tags:
        - newsletters-admin-api
      responses:
        "204":
          description: Newsletter deleted successfully
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/newsletters/{newsletter-id}/test:
    parameters:
      - name: newsletter-id
        in: path
        description: Newsletter ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: testNewsletter
      summary: Send a test newsletter to the current admin user
      tags:
        - newsletters-admin-api
      responses:
        "200":
          description: Test newsletter sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Test newsletter sent successfully"
                  sentTo:
                    type: string
                    example: "admin@example.com"
        "404":
          $ref: "#/components/responses/NotFound"
        "400":
          $ref: "#/components/responses/BadRequest"

  /admin/newsletters/{newsletter-id}/send:
    parameters:
      - name: newsletter-id
        in: path
        description: Newsletter ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: sendNewsletter
      summary: Send newsletter immediately or schedule it
      tags:
        - newsletters-admin-api
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                scheduledAt:
                  type: string
                  format: date-time
                  description: Optional scheduled send time. If not provided, sends immediately
                  example: "2024-01-15T10:00:00Z"
      responses:
        "200":
          description: Newsletter sent or scheduled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Newsletter scheduled successfully"
                  scheduledAt:
                    type: string
                    format: date-time
                    example: "2024-01-15T10:00:00Z"
                  recipientCount:
                    type: integer
                    example: 150
        "404":
          $ref: "#/components/responses/NotFound"
        "400":
          $ref: "#/components/responses/BadRequest"

  /admin/newsletters/{newsletter-id}/cancel:
    parameters:
      - name: newsletter-id
        in: path
        description: Newsletter ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: cancelNewsletter
      summary: Cancel a scheduled newsletter
      tags:
        - newsletters-admin-api
      responses:
        "200":
          description: Newsletter cancelled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Newsletter cancelled successfully"
        "404":
          $ref: "#/components/responses/NotFound"
        "400":
          description: Newsletter cannot be cancelled (already sent or not scheduled)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CodedError"

  /admin/newsletters/{newsletter-id}/logs:
    parameters:
      - name: newsletter-id
        in: path
        description: Newsletter ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getNewsletterLogs
      summary: Get audit logs for a newsletter (simple text logs)
      tags:
        - newsletters-admin-api
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          required: false
          schema:
            type: integer
            default: 0
        - name: pageSize
          in: query
          description: Number of log entries per page
          required: false
          schema:
            type: integer
            default: 100
        - name: level
          in: query
          description: Filter by log level
          required: false
          schema:
            type: string
            enum: ["INFO", "WARN", "ERROR"]
      responses:
        "200":
          description: Newsletter audit logs
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/NewsletterLogsResponse"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/email-templates:
    get:
      operationId: getEmailTemplates
      summary: Retrieve all email templates
      tags:
        - email-templates-admin-api
      parameters:
        - name: type
          in: query
          description: Filter by email template type
          required: false
          schema:
            $ref: "#/components/schemas/EmailTemplateType"
      responses:
        "200":
          description: A list of email templates
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/EmailTemplate"
    post:
      operationId: createEmailTemplate
      summary: Create a new email template
      tags:
        - email-templates-admin-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/EmailTemplateRequest"
      responses:
        "201":
          description: Email template created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailTemplate"
        "400":
          $ref: "#/components/responses/BadRequest"

  /admin/email-templates/{template-id}:
    parameters:
      - name: template-id
        in: path
        description: Email template ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getEmailTemplate
      summary: Retrieve a specific email template by ID
      tags:
        - email-templates-admin-api
      responses:
        "200":
          description: A single email template
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailTemplate"
        "404":
          $ref: "#/components/responses/NotFound"
    put:
      operationId: updateEmailTemplate
      summary: Update an existing email template
      tags:
        - email-templates-admin-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/EmailTemplateRequest"
      responses:
        "200":
          description: Email template updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/EmailTemplate"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"
    delete:
      operationId: deleteEmailTemplate
      summary: Delete an email template
      tags:
        - email-templates-admin-api
      responses:
        "204":
          description: Email template deleted successfully
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/email-templates/{template-id}/test:
    parameters:
      - name: template-id
        in: path
        description: Email template ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: testEmailTemplate
      summary: Send a test email using the template to the current admin user
      tags:
        - email-templates-admin-api
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                templateVariables:
                  type: object
                  additionalProperties: true
                  description: "Template variables to use for testing (e.g., username, verif_url, etc.)"
                  example:
                    username: "testuser"
                    verif_url: "https://portal.neohoods.com/email-confirmation?token=test123"
      responses:
        "200":
          description: Test email sent successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Test email sent successfully"
                  sentTo:
                    type: string
                    example: "admin@example.com"
        "404":
          $ref: "#/components/responses/NotFound"
        "400":
          $ref: "#/components/responses/BadRequest"

  # ========================================
  # SPACES & RESERVATIONS API
  # ========================================

  /spaces/spaces:
    get:
      operationId: getSpaces
      summary: Retrieve all available spaces
      tags:
        - spaces-api
      parameters:
        - name: type
          in: query
          description: Filter by space type
          required: false
          schema:
            $ref: "#/components/schemas/SpaceType"
        - name: available
          in: query
          description: Filter by availability
          required: false
          schema:
            type: boolean
        - name: startDate
          in: query
          description: Filter by start date
          required: false
          schema:
            type: string
            format: date
        - name: endDate
          in: query
          description: Filter by end date
          required: false
          schema:
            type: string
            format: date
        - name: search
          in: query
          description: Search query
          required: false
          schema:
            type: string
        - name: page
          in: query
          description: Page number (1-based)
          required: false
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: size
          in: query
          description: Number of items per page
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 12
      responses:
        "200":
          description: A paginated list of spaces
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedSpaces"

  /spaces/spaces/{space-id}:
    parameters:
      - name: space-id
        in: path
        description: Space ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getSpace
      summary: Retrieve a specific space by ID
      tags:
        - spaces-api
      responses:
        "200":
          description: A single space
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Space"
        "404":
          $ref: "#/components/responses/NotFound"

  /spaces/spaces/{space-id}/shared-reservations:
    parameters:
      - name: space-id
        in: path
        description: Space ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getSharedSpaceReservations
      summary: Retrieve reservations of spaces that share the same physical space
      description: Returns all reservations from spaces that share the physical space with this space, useful for displaying in calendars
      tags:
        - spaces-api
      parameters:
        - name: startDate
          in: query
          description: Start date for filtering reservations
          required: true
          schema:
            type: string
            format: date
        - name: endDate
          in: query
          description: End date for filtering reservations
          required: true
          schema:
            type: string
            format: date
      responses:
        "200":
          description: List of reservations from shared spaces
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/Reservation"
        "404":
          $ref: "#/components/responses/NotFound"

  /spaces/spaces/{space-id}/availability:
    parameters:
      - name: space-id
        in: path
        description: Space ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getSpaceAvailability
      summary: Check availability for a space in a date range
      tags:
        - spaces-api
      parameters:
        - name: startDate
          in: query
          required: true
          schema:
            type: string
            format: date
        - name: endDate
          in: query
          required: true
          schema:
            type: string
            format: date
      responses:
        "200":
          description: Availability information
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AvailabilityResponse"

  /spaces/spaces/{space-id}/price-breakdown:
    parameters:
      - name: space-id
        in: path
        description: Space ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getPriceBreakdown
      summary: Get price breakdown for a space
      description: Calculate and return the complete price breakdown for a space for given dates. The breakdown includes unit price, number of days, subtotal, fees, and total price.
      tags:
        - spaces-api
      security:
        - BearerAuthOAuth: []
      parameters:
        - name: startDate
          in: query
          required: true
          schema:
            type: string
            format: date
          description: Start date for the reservation
        - name: endDate
          in: query
          required: true
          schema:
            type: string
            format: date
          description: End date for the reservation (inclusive)
      responses:
        "200":
          description: Price breakdown calculated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PriceBreakdown"
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  /spaces/spaces/{space-id}/occupancy-calendar:
    parameters:
      - name: space-id
        in: path
        description: Space ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getSpaceOccupancyCalendar
      summary: Get occupancy calendar for a space (public endpoint)
      description: Returns occupancy calendar data for a space. Only includes reservationId if the reservation belongs to the current authenticated user.
      tags:
        - spaces-api
      security:
        - BearerAuthOAuth: []
      parameters:
        - name: startDate
          in: query
          required: false
          schema:
            type: string
            format: date
          description: Start date for the calendar range (defaults to January 1st of current year)
        - name: endDate
          in: query
          required: false
          schema:
            type: string
            format: date
          description: End date for the calendar range (defaults to December 31st of current year)
      responses:
        "200":
          description: Occupancy calendar data
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SpaceOccupancyCalendarResponse"
        "404":
          $ref: "#/components/responses/NotFound"
        "401":
          $ref: "#/components/responses/Unauthorized"
  /public/spaces/{space-id}/calendar.ics:
    parameters:
      - name: space-id
        in: path
        description: Space ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getSpaceCleaningCalendar
      summary: Get calendar feed for a space (iCalendar format)
      description: |
        Returns an iCalendar (.ics) feed for the space. Requires a valid JWT token for authentication.
        
        The `type` parameter determines the calendar content:
        - `cleaning`: Returns cleaning schedules based on reservation checkout dates
        - `reservation`: Returns reservation schedules. If userId is present in the JWT token, only that user's reservations are returned; otherwise all space reservations are returned.
      tags:
        - public-spaces-api
      parameters:
        - name: token
          in: query
          required: true
          description: JWT token for calendar access (must include type claim matching the type parameter)
          schema:
            type: string
        - name: type
          in: query
          required: false
          description: Calendar type (cleaning or reservation)
          schema:
            type: string
            enum:
              - cleaning
              - reservation
            default: cleaning
      responses:
        "200":
          description: Calendar feed in iCalendar format
          content:
            text/calendar:
              schema:
                type: string
        "401":
          $ref: "#/components/responses/Unauthorized"
          description: Invalid or expired token
        "404":
          $ref: "#/components/responses/NotFound"
          description: Space not found

  /public/users/{user-id}/calendar.ics:
    parameters:
      - name: user-id
        in: path
        description: User ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getUserCalendar
      summary: Get user's personal reservation calendar (iCalendar format)
      description: Returns an iCalendar (.ics) feed containing all reservations across all spaces for the specified user. Requires a valid JWT token where the userId claim matches the path parameter.
      tags:
        - public-users-api
      parameters:
        - name: token
          in: query
          required: true
          description: JWT token for calendar access (must include userId claim matching the user-id path parameter)
          schema:
            type: string
      responses:
        "200":
          description: Calendar feed in iCalendar format
          content:
            text/calendar:
              schema:
                type: string
        "401":
          $ref: "#/components/responses/Unauthorized"
          description: Invalid or expired token, or userId mismatch
        "404":
          $ref: "#/components/responses/NotFound"
          description: User not found

  /spaces/reservations:
    get:
      operationId: getMyReservations
      summary: Retrieve current user's reservations
      tags:
        - reservations-api
      parameters:
        - name: status
          in: query
          description: Filter by reservation status
          required: false
          schema:
            $ref: "#/components/schemas/ReservationStatus"
        - name: spaceType
          in: query
          description: Filter by space type
          required: false
          schema:
            $ref: "#/components/schemas/SpaceType"
        - name: page
          in: query
          description: Page number (1-based)
          required: false
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: size
          in: query
          description: Number of items per page
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 10
      responses:
        "200":
          description: A paginated list of user's reservations
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedReservations"

    post:
      operationId: createReservation
      summary: Create a new reservation
      tags:
        - reservations-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreateReservationRequest"
      responses:
        "201":
          description: Reservation created with Stripe checkout session
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CreateReservationResponse"
        "400":
          $ref: "#/components/responses/BadRequest"
        "409":
          description: Conflict - dates not available or quota exceeded
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CodedError"

  /spaces/reservations/{reservation-id}:
    parameters:
      - name: reservation-id
        in: path
        description: Reservation ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getReservation
      summary: Retrieve a specific reservation
      tags:
        - reservations-api
      responses:
        "200":
          description: A single reservation
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Reservation"
        "404":
          $ref: "#/components/responses/NotFound"

    delete:
      operationId: cancelReservation
      summary: Cancel a reservation
      tags:
        - reservations-api
      responses:
        "200":
          description: Reservation cancelled, refund initiated
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  refundAmount:
                    type: number
                    format: float
        "404":
          $ref: "#/components/responses/NotFound"
        "400":
          description: Cannot cancel (too late or already completed)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CodedError"

  /spaces/reservations/{reservation-id}/feedback:
    parameters:
      - name: reservation-id
        in: path
        description: Reservation ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: submitReservationFeedback
      summary: Submit feedback after reservation completion
      tags:
        - reservations-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ReservationFeedbackRequest"
      responses:
        "201":
          description: Feedback submitted successfully
        "404":
          $ref: "#/components/responses/NotFound"

  /spaces/reservations/{reservation-id}/payment:
    parameters:
      - name: reservation-id
        in: path
        description: Reservation ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: initiatePayment
      summary: Initiate payment for a reservation
      tags:
        - reservations-api
      responses:
        "200":
          description: Payment session created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaymentSessionResponse"
        "404":
          $ref: "#/components/responses/NotFound"
        "400":
          description: Cannot initiate payment (reservation not in valid state)
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/CodedError"

  /public/stripe/webhook:
    post:
      operationId: handleStripeWebhook
      summary: Handle Stripe webhook events
      tags:
        - stripe-webhook-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              description: Stripe event payload
      responses:
        "200":
          description: Webhook processed successfully
        "400":
          description: Invalid webhook signature

  /public/reservations/{reservationId}/payment/confirm:
    post:
      operationId: confirmReservationPayment
      summary: Confirm reservation payment status
      tags:
        - reservations-api
      parameters:
        - name: reservationId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sessionId:
                  type: string
                  description: Stripe checkout session ID
                  example: "cs_test_123456789"
                status:
                  type: string
                  enum: [success, cancelled]
                  description: Payment status from frontend
              required:
                - sessionId
                - status
      responses:
        "200":
          description: Payment status confirmed
          content:
            application/json:
              schema:
                type: object
                properties:
                  reservationId:
                    type: string
                    format: uuid
                  status:
                    $ref: "#/components/schemas/ReservationStatus"
                  message:
                    type: string
        "400":
          $ref: "#/components/responses/BadRequest"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/spaces:
    get:
      operationId: getAdminSpaces
      summary: Retrieve all spaces (admin)
      tags:
        - spaces-admin-api
      parameters:
        - name: type
          in: query
          description: Filter by space type
          required: false
          schema:
            $ref: "#/components/schemas/SpaceType"
        - name: status
          in: query
          description: Filter by space status
          required: false
          schema:
            $ref: "#/components/schemas/SpaceStatus"
        - name: search
          in: query
          description: Search query
          required: false
          schema:
            type: string
        - name: page
          in: query
          description: Page number (1-based)
          required: false
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: size
          in: query
          description: Number of items per page
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
      responses:
        "200":
          description: A paginated list of all spaces
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedSpaces"

    post:
      operationId: createSpace
      summary: Create a new space
      tags:
        - spaces-admin-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SpaceRequest"
      responses:
        "201":
          description: Space created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Space"

  /admin/spaces/{space-id}:
    parameters:
      - name: space-id
        in: path
        description: Space ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getAdminSpace
      summary: Retrieve a specific space (admin)
      tags:
        - spaces-admin-api
      responses:
        "200":
          description: A single space
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Space"
        "404":
          $ref: "#/components/responses/NotFound"

    put:
      operationId: updateSpace
      summary: Update a space
      tags:
        - spaces-admin-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/SpaceRequest"
      responses:
        "200":
          description: Space updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Space"

    delete:
      operationId: deleteSpace
      summary: Delete a space
      tags:
        - spaces-admin-api
      responses:
        "204":
          description: Space deleted successfully

  /admin/spaces/settings:
    get:
      operationId: getSpacesSettings
      summary: Get all configurable space settings
      tags:
        - spaces-admin-api
      responses:
        "200":
          description: Space settings
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PlatformFeeSettings"

    put:
      operationId: updateSpaceSettings
      summary: Update space settings
      tags:
        - spaces-admin-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PlatformFeeSettings"
      responses:
        "200":
          description: Settings updated successfully

  /admin/reservations:
    get:
      operationId: getAdminReservations
      summary: Retrieve all reservations (admin)
      tags:
        - reservations-admin-api
      parameters:
        - name: spaceId
          in: query
          required: false
          schema:
            type: string
            format: uuid
        - name: userId
          in: query
          required: false
          schema:
            type: string
            format: uuid
        - name: status
          in: query
          required: false
          schema:
            $ref: "#/components/schemas/ReservationStatus"
        - name: startDate
          in: query
          required: false
          schema:
            type: string
            format: date
        - name: endDate
          in: query
          required: false
          schema:
            type: string
            format: date
        - name: spaceType
          in: query
          required: false
          schema:
            $ref: "#/components/schemas/SpaceType"
          description: Filter reservations by space type
        - name: search
          in: query
          required: false
          schema:
            type: string
          description: Search reservations by space name or description
        - name: page
          in: query
          description: Page number (1-based)
          required: false
          schema:
            type: integer
            minimum: 0
            default: 0
        - name: size
          in: query
          description: Number of items per page
          required: false
          schema:
            type: integer
            minimum: 1
            maximum: 100
            default: 20
      responses:
        "200":
          description: A paginated list of all reservations
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PaginatedReservations"

  /admin/reservations/{reservation-id}:
    parameters:
      - name: reservation-id
        in: path
        description: Reservation ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getAdminReservation
      summary: Retrieve a specific reservation (admin)
      tags:
        - reservations-admin-api
      responses:
        "200":
          description: A single reservation with full details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Reservation"

  /admin/reservations/{reservation-id}/access-code:
    parameters:
      - name: reservation-id
        in: path
        description: Reservation ID
        required: true
        schema:
          type: string
          format: uuid
    post:
      operationId: regenerateAccessCode
      summary: Regenerate access code for a reservation
      tags:
        - reservations-admin-api
      responses:
        "200":
          description: New access code generated
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccessCode"

    get:
      operationId: getAccessCode
      summary: Get access code for a reservation
      tags:
        - reservations-admin-api
      responses:
        "200":
          description: Access code
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccessCode"

  /admin/reservations/{reservation-id}/audit-logs:
    parameters:
      - name: reservation-id
        in: path
        description: Reservation ID
        required: true
        schema:
          type: string
          format: uuid
    get:
      operationId: getReservationAuditLogs
      summary: Get audit logs for a specific reservation
      tags:
        - reservations-admin-api
      responses:
        "200":
          description: Successfully retrieved audit logs
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ReservationAuditLog"
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/digital-locks:
    get:
      operationId: getDigitalLocks
      summary: Retrieve all digital locks
      tags:
        - digital-lock-admin-api
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 0
        - name: size
          in: query
          schema:
            type: integer
            default: 20
        - name: name
          in: query
          schema:
            type: string
        - name: type
          in: query
          schema:
            $ref: "#/components/schemas/DigitalLockType"
        - name: status
          in: query
          schema:
            $ref: "#/components/schemas/DigitalLockStatus"
      responses:
        "200":
          description: List of digital locks
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/DigitalLock"

    post:
      operationId: createDigitalLock
      summary: Create a new digital lock
      tags:
        - digital-lock-admin-api
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DigitalLock"
      responses:
        "201":
          description: Digital lock created successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DigitalLock"
        "400":
          $ref: "#/components/responses/BadRequest"

  /admin/digital-locks/{lock-id}:
    get:
      operationId: getDigitalLock
      summary: Retrieve a digital lock by ID
      tags:
        - digital-lock-admin-api
      parameters:
        - name: lock-id
          in: path
          required: true
          description: Digital lock ID
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Digital lock details
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DigitalLock"
        "404":
          $ref: "#/components/responses/NotFound"

    put:
      operationId: updateDigitalLock
      summary: Update a digital lock
      tags:
        - digital-lock-admin-api
      parameters:
        - name: lock-id
          in: path
          required: true
          description: Digital lock ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/DigitalLock"
      responses:
        "200":
          description: Digital lock updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DigitalLock"
        "404":
          $ref: "#/components/responses/NotFound"
        "400":
          $ref: "#/components/responses/BadRequest"

    delete:
      operationId: deleteDigitalLock
      summary: Delete a digital lock
      tags:
        - digital-lock-admin-api
      parameters:
        - name: lock-id
          in: path
          required: true
          description: Digital lock ID
          schema:
            type: string
            format: uuid
      responses:
        "204":
          description: Digital lock deleted successfully
        "404":
          $ref: "#/components/responses/NotFound"

  /admin/digital-locks/{lock-id}/status:
    patch:
      operationId: updateDigitalLockStatus
      summary: Update digital lock status
      tags:
        - digital-lock-admin-api
      parameters:
        - name: lock-id
          in: path
          required: true
          description: Digital lock ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  $ref: "#/components/schemas/DigitalLockStatus"
      responses:
        "200":
          description: Digital lock status updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DigitalLock"
        "404":
          $ref: "#/components/responses/NotFound"
        "400":
          $ref: "#/components/responses/BadRequest"

  /admin/digital-locks/{lock-id}/generate-code:
    post:
      operationId: generateDigitalLockAccessCode
      summary: Generate a temporary access code for a digital lock
      tags:
        - digital-lock-admin-api
      parameters:
        - name: lock-id
          in: path
          required: true
          description: Digital lock ID
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                duration:
                  type: integer
                  description: Duration in hours
                  example: 24
                reason:
                  type: string
                  description: Reason for generating the code
                  example: "Temporary access for maintenance"
      responses:
        "200":
          description: Access code generated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AccessCode"
        "404":
          $ref: "#/components/responses/NotFound"
        "400":
          $ref: "#/components/responses/BadRequest"

  /admin/digital-locks/stats:
    get:
      operationId: getDigitalLockStats
      summary: Get digital lock statistics
      tags:
        - digital-lock-admin-api
      responses:
        "200":
          description: Digital lock statistics
          content:
            application/json:
              schema:
                type: object
                properties:
                  total:
                    type: integer
                  byStatus:
                    type: object
                    properties:
                      active:
                        type: integer
                      inactive:
                        type: integer
                      error:
                        type: integer
                  byType:
                    type: object
                    properties:
                      ttlock:
                        type: integer
                      nuki:
                        type: integer
                      yale:
                        type: integer
                      other:
                        type: integer

  /admin/spaces/{space-id}/statistics:
    get:
      operationId: getSpaceStatistics
      summary: Get statistics for a specific space
      tags:
        - spaces-admin-api
      parameters:
        - name: space-id
          in: path
          required: true
          schema:
            type: string
            format: uuid
        - name: startDate
          in: query
          required: false
          schema:
            type: string
            format: date
        - name: endDate
          in: query
          required: false
          schema:
            type: string
            format: date
      responses:
        "200":
          description: Space statistics
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SpaceStatistics"
        "404":
          $ref: "#/components/responses/NotFound"

  # Image endpoints
  /api/spaces/images/{imageId}:
    get:
      operationId: getImage
      summary: Get image by ID
      tags:
        - images-api
      parameters:
        - name: imageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Image data
          content:
            image/*:
              schema:
                type: string
                format: binary
        "404":
          description: Image not found

  /api/spaces/images/{imageId}/metadata:
    get:
      operationId: getImageMetadata
      summary: Get image metadata
      tags:
        - images-api
      parameters:
        - name: imageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Image metadata
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ImageMetadata"
        "404":
          description: Image not found

  /api/admin/images/spaces/{spaceId}:
    post:
      operationId: uploadSpaceImage
      summary: Upload image for a space
      tags:
        - images-admin-api
      parameters:
        - name: spaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
                altText:
                  type: string
                isPrimary:
                  type: boolean
                  default: false
                orderIndex:
                  type: integer
      responses:
        "200":
          description: Image uploaded successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SpaceImage"
        "400":
          description: Bad request
        "404":
          description: Space not found
    get:
      operationId: getSpaceImages
      summary: Get all images for a space
      tags:
        - images-admin-api
      parameters:
        - name: spaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: List of space images
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/SpaceImage"
        "404":
          description: Space not found

  /api/admin/images/spaces/{spaceId}/url:
    post:
      operationId: addExternalImage
      summary: Add external image URL to a space
      tags:
        - images-admin-api
      parameters:
        - name: spaceId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                url:
                  type: string
                  format: uri
                altText:
                  type: string
                isPrimary:
                  type: boolean
                  default: false
                orderIndex:
                  type: integer
              required:
                - url
      responses:
        "200":
          description: External image added successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SpaceImage"
        "404":
          description: Space not found

  /api/admin/images/{imageId}:
    put:
      operationId: updateImage
      summary: Update image metadata
      tags:
        - images-admin-api
      parameters:
        - name: imageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      requestBody:
        required: true
        content:
          application/x-www-form-urlencoded:
            schema:
              type: object
              properties:
                altText:
                  type: string
                isPrimary:
                  type: boolean
                orderIndex:
                  type: integer
      responses:
        "200":
          description: Image updated successfully
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/SpaceImage"
        "404":
          description: Image not found
    delete:
      operationId: deleteImage
      summary: Delete an image
      tags:
        - images-admin-api
      parameters:
        - name: imageId
          in: path
          required: true
          schema:
            type: string
            format: uuid
      responses:
        "200":
          description: Image deleted successfully
        "404":
          description: Image not found

  /admin/matrix-bot/status:
    get:
      operationId: getMatrixBotStatus
      summary: Get Matrix bot status
      tags:
        - matrix-bot-admin-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: Matrix bot status
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MatrixBotStatus"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/matrix-bot/oauth2/redirect-uri:
    get:
      operationId: getMatrixBotOAuth2RedirectUri
      summary: Get OAuth2 redirect URI for Matrix bot
      tags:
        - matrix-bot-admin-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: OAuth2 redirect URI
          content:
            application/json:
              schema:
                type: object
                required:
                  - redirectUri
                properties:
                  redirectUri:
                    type: string
                    format: uri
                    example: "https://chat.neohoods.com/_matrix/client/v3/oauth2/authorize?client_id=..."
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/matrix-bot/oauth2/callback:
    get:
      operationId: handleMatrixBotOAuth2Callback
      summary: Handle OAuth2 callback for Matrix bot
      tags:
        - matrix-bot-admin-api
      security:
        - BearerAuthOAuth: []
      parameters:
        - name: code
          in: query
          description: Authorization code from OAuth2 provider
          required: true
          schema:
            type: string
        - name: state
          in: query
          description: State parameter for OAuth2 flow
          required: true
          schema:
            type: string
      responses:
        "200":
          description: OAuth2 callback processed successfully
          content:
            application/json:
              schema:
                type: object
                required:
                  - success
                  - message
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "OAuth2 tokens saved successfully"
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/matrix-bot/oauth2/device-code:
    get:
      operationId: getMatrixBotDeviceCode
      summary: Get device code for Matrix bot OAuth2 flow
      tags:
        - matrix-bot-admin-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: Device code information
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/GetMatrixBotDeviceCode200Response"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/matrix-bot/oauth2/device-code/poll:
    post:
      operationId: pollMatrixBotDeviceCode
      summary: Poll device code status for Matrix bot OAuth2 flow
      tags:
        - matrix-bot-admin-api
      security:
        - BearerAuthOAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PollMatrixBotDeviceCodeRequest"
      responses:
        "200":
          description: Device code polling result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PollMatrixBotDeviceCode200Response"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

  /admin/matrix-bot/initialize:
    post:
      operationId: initializeMatrixBot
      summary: Manually trigger Matrix bot initialization
      tags:
        - matrix-bot-admin-api
      security:
        - BearerAuthOAuth: []
      responses:
        "200":
          description: Initialization result
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/InitializeMatrixBot200Response"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"

components:
  #####################################################
  # Predefined Components
  #####################################################

  securitySchemes:
    BearerAuthOAuth:
      description: Bearer Token.
      type: http
      scheme: bearer

  parameters:
    itemId:
      name: item-id
      in: path
      description: Item ID
      required: true
      schema:
        type: string
        format: uuid
    userId:
      name: user-id
      in: path
      description: User ID
      required: true
      schema:
        type: string
        format: uuid
  schemas:
    # ========================================
    # SPACES & RESERVATIONS SCHEMAS
    # ========================================

    SpaceType:
      type: string
      enum:
        - GUEST_ROOM
        - COMMON_ROOM
        - COWORKING
        - PARKING
      description: Type of space available for reservation

    SpaceStatus:
      type: string
      enum:
        - ACTIVE
        - INACTIVE
        - MAINTENANCE
      description: Current status of the space

    Space:
      type: object
      required:
        - id
        - name
        - type
        - status
        - description
        - instructions
        - pricing
        - rules
        - images
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
          example: "Chambre d'amis - Appartement 2A"
        type:
          $ref: "#/components/schemas/SpaceType"
        status:
          $ref: "#/components/schemas/SpaceStatus"
        description:
          type: string
          example: "Chambre d'amis de 15m avec lit double, bureau et placard"
        instructions:
          type: string
          example: "Code d'accs envoy par email. Nettoyage obligatoire avant dpart."
        pricing:
          $ref: "#/components/schemas/SpacePricing"
        rules:
          $ref: "#/components/schemas/SpaceRules"
        images:
          type: array
          items:
            $ref: "#/components/schemas/SpaceImage"
        quota:
          $ref: "#/components/schemas/QuotaInfo"
        capacity:
          type: integer
          minimum: 1
          description: "Number of people allowed in the space at the same time"
          example: 2
        digitalLockId:
          type: string
          format: uuid
          description: "ID of associated digital lock"
        accessCodeEnabled:
          type: boolean
          default: true
          example: true
        cleaningSettings:
          $ref: "#/components/schemas/CleaningSettings"
        reservationCalendarUrl:
          type: string
          format: uri
          readOnly: true
          description: Calendar feed URL for all reservations in this space (iCalendar format)
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    SpacePricing:
      type: object
      required:
        - ownerPrice
        - tenantPrice
        - currency
      properties:
        ownerPrice:
          type: number
          format: float
          example: 15.0
          description: "Daily price for owners (propritaires)"
        tenantPrice:
          type: number
          format: float
          example: 20.0
          description: "Daily price for tenants (locataires)"
        currency:
          type: string
          example: "EUR"
        cleaningFee:
          type: number
          format: float
          example: 25.0
        deposit:
          type: number
          format: float
          example: 50.0

    PlatformFeeSettings:
      type: object
      required:
        - platformFeePercentage
        - platformFixedFee
      properties:
        platformFeePercentage:
          type: number
          format: float
          example: 2.0
          description: "Platform fee percentage (e.g., 2.0 for 2.0%)"
        platformFixedFee:
          type: number
          format: float
          example: 0.25
          description: "Fixed platform fee per transaction in euros"

    SpaceRules:
      type: object
      required:
        - minDurationDays
        - maxDurationDays
        - allowedDays
        - allowedHours
      properties:
        minDurationDays:
          type: integer
          minimum: 1
          example: 3
        maxDurationDays:
          type: integer
          minimum: 1
          example: 7
        allowedDays:
          type: array
          items:
            type: string
            enum:
              [
                "MONDAY",
                "TUESDAY",
                "WEDNESDAY",
                "THURSDAY",
                "FRIDAY",
                "SATURDAY",
                "SUNDAY",
              ]
          example: ["WEDNESDAY", "SATURDAY", "SUNDAY"]
        allowedHours:
          $ref: "#/components/schemas/TimeRange"
        cleaningDays:
          type: array
          items:
            type: string
            enum:
              [
                "MONDAY",
                "TUESDAY",
                "WEDNESDAY",
                "THURSDAY",
                "FRIDAY",
                "SATURDAY",
                "SUNDAY",
              ]
          example: ["MONDAY", "FRIDAY"]
        shareSpaceWith:
          type: array
          items:
            type: string
            format: uuid
          description: "Liste des UUIDs des espaces qui partagent le mme espace physique. La bidirectionnalit est gre automatiquement par le backend."
          example: ["550e8400-e29b-41d4-a716-446655440001"]

    TimeRange:
      type: object
      required:
        - start
        - end
      properties:
        start:
          type: string
          pattern: "^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$"
          example: "08:00"
        end:
          type: string
          pattern: "^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$"
          example: "20:00"

    QuotaInfo:
      type: object
      required:
        - max
        - period
      properties:
        max:
          type: integer
          minimum: 1
          example: 4
        period:
          type: string
          enum: ["YEAR", "MONTH", "WEEK"]
          example: "YEAR"
        resetDate:
          type: string
          format: date
          example: "2024-01-01"

    ReservationStatus:
      type: string
      enum:
        - PENDING_PAYMENT
        - PAYMENT_FAILED
        - EXPIRED
        - CONFIRMED
        - ACTIVE
        - COMPLETED
        - CANCELLED
        - REFUNDED
      description: Current status of the reservation

    Reservation:
      type: object
      required:
        - id
        - spaceId
        - userId
        - startDate
        - endDate
        - status
        - totalPrice
        - currency
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          format: uuid
        spaceId:
          type: string
          format: uuid
        userId:
          type: string
          format: uuid
        unitId:
          type: string
          format: uuid
          description: Unit ID associated with this reservation
        space:
          $ref: "#/components/schemas/Space"
        user:
          $ref: "#/components/schemas/User"
        startDate:
          type: string
          format: date
          example: "2024-02-15"
        endDate:
          type: string
          format: date
          example: "2024-02-18"
        status:
          $ref: "#/components/schemas/ReservationStatus"
        totalPrice:
          type: number
          format: float
          example: 60.0
        currency:
          type: string
          example: "EUR"
        cleaningFee:
          type: number
          format: float
          example: 25.0
        deposit:
          type: number
          format: float
          example: 50.0
        platformFeeAmount:
          type: number
          format: float
          example: 1.2
          description: "Platform fee amount (percentage-based)"
        platformFixedFeeAmount:
          type: number
          format: float
          example: 0.25
          description: "Fixed platform fee amount per transaction"
        stripeSessionId:
          type: string
          example: "cs_test_123456789"
        stripePaymentIntentId:
          type: string
          example: "pi_123456789"
        accessCode:
          $ref: "#/components/schemas/AccessCode"
        feedback:
          $ref: "#/components/schemas/ReservationFeedback"
        paymentExpiresAt:
          type: string
          format: date-time
          description: "When the payment expires (15 minutes after creation)"
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        priceBreakdown:
          $ref: "#/components/schemas/PriceBreakdown"
          description: "Complete price breakdown with all pricing details"

    PriceBreakdown:
      type: object
      properties:
        unitPrice:
          type: number
          format: float
          example: 50.0
          description: "Price per unit (day/night)"
        numberOfDays:
          type: integer
          example: 2
          description: "Number of days/nights (generic term, translation is done in UI)"
        totalDaysPrice:
          type: number
          format: float
          example: 100.0
          description: "Total price for days/nights (unitPrice  numberOfDays)"
        cleaningFee:
          type: number
          format: float
          example: 25.0
          description: "Cleaning fee"
        subtotal:
          type: number
          format: float
          example: 125.0
          description: "Subtotal including totalDaysPrice and cleaning fees (totalDaysPrice + cleaningFee)"
        deposit:
          type: number
          format: float
          example: 50.0
          description: "Deposit amount"
        platformFeeAmount:
          type: number
          format: float
          example: 1.2
          description: "Platform fee amount (percentage-based)"
        platformFixedFeeAmount:
          type: number
          format: float
          example: 0.25
          description: "Fixed platform fee amount per transaction"
        totalPrice:
          type: number
          format: float
          example: 176.45
          description: "Total price including all fees"

    ReservationAuditLog:
      type: object
      required:
        - id
        - reservationId
        - eventType
        - logMessage
        - performedBy
        - createdAt
      properties:
        id:
          type: string
          format: uuid
        reservationId:
          type: string
          format: uuid
        eventType:
          type: string
          enum:
            - STATUS_CHANGE
            - CODE_GENERATED
            - CODE_REGENERATED
            - PAYMENT_RECEIVED
            - CANCELLED
            - CONFIRMED
            - ENTRY_LOGGED
            - EXIT_LOGGED
        oldValue:
          type: string
          nullable: true
        newValue:
          type: string
          nullable: true
        logMessage:
          type: string
        performedBy:
          type: string
        createdAt:
          type: string
          format: date-time

    CreateReservationRequest:
      type: object
      required:
        - spaceId
        - startDate
        - endDate
      properties:
        spaceId:
          type: string
          format: uuid
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        specialRequests:
          type: string
          maxLength: 500

    CreateReservationResponse:
      type: object
      required:
        - reservation
      properties:
        reservation:
          $ref: "#/components/schemas/Reservation"

    PaymentSessionResponse:
      type: object
      required:
        - stripeCheckoutUrl
        - paymentIntentId
      properties:
        stripeCheckoutUrl:
          type: string
          format: uri
          example: "https://checkout.stripe.com/c/pay/cs_test_123456789"
        paymentIntentId:
          type: string
          example: "pi_123456789"

    AvailabilityResponse:
      type: object
      required:
        - available
        - conflicts
        - quota
      properties:
        available:
          type: boolean
        conflicts:
          type: array
          items:
            $ref: "#/components/schemas/ReservationConflict"
        quota:
          $ref: "#/components/schemas/QuotaInfo"
        price:
          type: number
          format: float
        currency:
          type: string

    ReservationConflict:
      type: object
      required:
        - type
        - message
      properties:
        type:
          type: string
          enum:
            [
              "SAME_DAY_BLOCK",
              "QUOTA_EXCEEDED",
              "CLEANING_DAY",
              "VACATION_PERIOD",
            ]
        message:
          type: string
        conflictingReservationId:
          type: string
          format: uuid

    AccessCode:
      type: object
      required:
        - code
        - generatedAt
        - expiresAt
      properties:
        code:
          type: string
          example: "ABC123"
        generatedAt:
          type: string
          format: date-time
        expiresAt:
          type: string
          format: date-time
        isActive:
          type: boolean
          example: true

    ReservationFeedback:
      type: object
      required:
        - rating
        - comment
        - submittedAt
      properties:
        id:
          type: string
          format: uuid
        rating:
          type: integer
          minimum: 1
          maximum: 5
          example: 4
        comment:
          type: string
          maxLength: 1000
        cleanliness:
          type: integer
          minimum: 1
          maximum: 5
        communication:
          type: integer
          minimum: 1
          maximum: 5
        value:
          type: integer
          minimum: 1
          maximum: 5
        submittedAt:
          type: string
          format: date-time

    ReservationFeedbackRequest:
      type: object
      required:
        - rating
        - comment
      properties:
        rating:
          type: integer
          minimum: 1
          maximum: 5
        comment:
          type: string
          maxLength: 1000
        cleanliness:
          type: integer
          minimum: 1
          maximum: 5
        communication:
          type: integer
          minimum: 1
          maximum: 5
        value:
          type: integer
          minimum: 1
          maximum: 5

    QuotaResponse:
      type: object
      required:
        - spaceType
        - max
        - remaining
        - period
      properties:
        spaceType:
          $ref: "#/components/schemas/SpaceType"
        max:
          type: integer
          minimum: 1
        remaining:
          type: integer
          minimum: 0
        period:
          type: string
          enum: ["YEAR", "MONTH", "WEEK"]
        resetDate:
          type: string
          format: date

    SpaceRequest:
      type: object
      required:
        - name
        - type
        - description
        - instructions
        - pricing
        - rules
      properties:
        name:
          type: string
          maxLength: 100
        type:
          $ref: "#/components/schemas/SpaceType"
        description:
          type: string
          maxLength: 1000
        instructions:
          type: string
          maxLength: 2000
        pricing:
          $ref: "#/components/schemas/SpacePricing"
        rules:
          $ref: "#/components/schemas/SpaceRules"
        images:
          type: array
          items:
            $ref: "#/components/schemas/SpaceImage"
        digitalLockId:
          type: string
          format: uuid
          description: "ID of associated digital lock"
        capacity:
          type: integer
          minimum: 1
          description: "Number of people allowed in the space at the same time"
          example: 2
        status:
          $ref: "#/components/schemas/SpaceStatus"
          description: "Space status (optional for updates)"
        cleaningSettings:
          $ref: "#/components/schemas/CleaningSettings"
          description: "Cleaning company integration settings"

    SpaceTypeSettings:
      type: object
      required:
        - guestRoomSettings
        - commonRoomSettings
        - coworkingSettings
        - parkingSettings
      properties:
        guestRoomSettings:
          $ref: "#/components/schemas/GuestRoomSettings"
        commonRoomSettings:
          $ref: "#/components/schemas/CommonRoomSettings"
        coworkingSettings:
          $ref: "#/components/schemas/CoworkingSettings"
        parkingSettings:
          $ref: "#/components/schemas/ParkingSettings"

    GuestRoomSettings:
      type: object
      required:
        - minDurationDays
        - maxDurationDays
        - cleaningDays
        - cleaningFee
        - ownerPrice
        - tenantPrice
      properties:
        minDurationDays:
          type: integer
          minimum: 1
        maxDurationDays:
          type: integer
          minimum: 1
        cleaningDays:
          type: array
          items:
            type: string
            enum:
              [
                "MONDAY",
                "TUESDAY",
                "WEDNESDAY",
                "THURSDAY",
                "FRIDAY",
                "SATURDAY",
                "SUNDAY",
              ]
        cleaningFee:
          type: number
          format: float
        ownerPrice:
          type: number
          format: float
        tenantPrice:
          type: number
          format: float

    CommonRoomSettings:
      type: object
      required:
        - allowedDays
        - allowedHours
        - ownerPrice
        - tenantPrice
        - vacationPeriods
      properties:
        allowedDays:
          type: array
          items:
            type: string
            enum:
              [
                "MONDAY",
                "TUESDAY",
                "WEDNESDAY",
                "THURSDAY",
                "FRIDAY",
                "SATURDAY",
                "SUNDAY",
              ]
        allowedHours:
          $ref: "#/components/schemas/TimeRange"
        ownerPrice:
          type: number
          format: float
        tenantPrice:
          type: number
          format: float
        vacationPeriods:
          type: array
          items:
            $ref: "#/components/schemas/DateRange"

    CoworkingSettings:
      type: object
      required:
        - maxDesks
        - maxDurationDays
        - ownerPrice
        - tenantPrice
      properties:
        maxDesks:
          type: integer
          minimum: 1
        maxDurationDays:
          type: integer
          minimum: 1
        ownerPrice:
          type: number
          format: float
        tenantPrice:
          type: number
          format: float

    ParkingSettings:
      type: object
      required:
        - maxDurationDays
        - numberedSpots
      properties:
        maxDurationDays:
          type: integer
          minimum: 1
        numberedSpots:
          type: array
          items:
            type: string
          example: ["A1", "A2", "B1", "B2"]

    DateRange:
      type: object
      required:
        - startDate
        - endDate
      properties:
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        reason:
          type: string
          example: "Vacances d't"

    CleaningSettings:
      type: object
      properties:
        cleaningEnabled:
          type: boolean
          default: false
          description: Whether cleaning company integration is enabled for this space
        cleaningEmail:
          type: string
          format: email
          description: Email address of the cleaning company
        cleaningNotificationsEnabled:
          type: boolean
          default: false
          description: Whether to send email notifications to the cleaning company
        cleaningCalendarEnabled:
          type: boolean
          default: false
          description: Whether to generate and share calendar feed with the cleaning company
        cleaningDaysAfterCheckout:
          type: integer
          minimum: 0
          default: 0
          description: Number of days after checkout when cleaning should occur (0 means same day as checkout)
        cleaningHour:
          type: string
          pattern: "^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$"
          default: "10:00"
          example: "10:00"
          description: Time when cleaning should occur (HH:MM format)
        calendarUrl:
          type: string
          format: uri
          readOnly: true
          description: Calendar feed URL (only present when cleaningCalendarEnabled is true)

    SpaceStatistics:
      type: object
      required:
        - spaceId
        - spaceName
        - period
        - occupancyRate
        - totalRevenue
        - totalReservations
        - totalDaysBooked
        - averageReservationDuration
        - topUsers
        - occupancyCalendar
        - monthlyOccupancy
      properties:
        spaceId:
          type: string
          format: uuid
        spaceName:
          type: string
        period:
          type: object
          required:
            - startDate
            - endDate
          properties:
            startDate:
              type: string
              format: date
            endDate:
              type: string
              format: date
        occupancyRate:
          type: number
          format: double
          description: Percentage of occupied days
        totalRevenue:
          type: number
          format: double
          description: Total revenue generated in euros
        totalReservations:
          type: integer
          description: Total number of reservations
        totalDaysBooked:
          type: integer
          description: Total number of days booked
        averageReservationDuration:
          type: number
          format: double
          description: Average duration of reservations in days
        topUsers:
          type: array
          items:
            $ref: "#/components/schemas/TopUser"
        occupancyCalendar:
          type: array
          items:
            $ref: "#/components/schemas/OccupancyCalendarDay"
        monthlyOccupancy:
          type: array
          items:
            $ref: "#/components/schemas/MonthlyOccupancy"

    TopUser:
      type: object
      required:
        - userId
        - userName
        - userEmail
        - reservationCount
        - totalDays
        - totalSpent
      properties:
        userId:
          type: string
        userName:
          type: string
        userEmail:
          type: string
          format: email
        reservationCount:
          type: integer
        totalDays:
          type: integer
        totalSpent:
          type: number
          format: double

    OccupancyCalendarDay:
      type: object
      required:
        - date
        - isOccupied
      properties:
        date:
          type: string
          format: date
        isOccupied:
          type: boolean
        reservationId:
          type: string
          format: uuid
        userName:
          type: string

    OccupancyCalendarDayPublic:
      type: object
      required:
        - date
        - isOccupied
      properties:
        date:
          type: string
          format: date
          description: The date for this calendar day
        isOccupied:
          type: boolean
          description: Whether the space is occupied on this day
        reservationId:
          type: string
          format: uuid
          description: Reservation ID - only populated if the reservation belongs to the current authenticated user

    SpaceOccupancyCalendarResponse:
      type: object
      required:
        - occupancyCalendar
      properties:
        occupancyCalendar:
          type: array
          items:
            $ref: "#/components/schemas/OccupancyCalendarDayPublic"
          description: List of calendar days with occupancy information

    MonthlyOccupancy:
      type: object
      required:
        - month
        - daysOccupied
        - daysAvailable
      properties:
        month:
          type: string
          description: Month abbreviation (e.g., "Jan", "Fv")
        daysOccupied:
          type: integer
          description: Number of days occupied in the month
        daysAvailable:
          type: integer
          description: Total number of days available in the month

    # ========================================
    # PAGINATION SCHEMAS
    # ========================================

    PaginatedSpaces:
      type: object
      required:
        - content
        - totalElements
        - totalPages
        - size
        - number
        - first
        - last
        - numberOfElements
      properties:
        content:
          type: array
          items:
            $ref: "#/components/schemas/Space"
        totalElements:
          type: integer
          format: int64
          description: Total number of elements across all pages
        totalPages:
          type: integer
          description: Total number of pages
        size:
          type: integer
          description: Number of elements per page
        number:
          type: integer
          description: Current page number (0-based)
        first:
          type: boolean
          description: Whether this is the first page
        last:
          type: boolean
          description: Whether this is the last page
        numberOfElements:
          type: integer
          description: Number of elements in current page

    PaginatedReservations:
      type: object
      required:
        - content
        - totalElements
        - totalPages
        - size
        - number
        - first
        - last
        - numberOfElements
      properties:
        content:
          type: array
          items:
            $ref: "#/components/schemas/Reservation"
        totalElements:
          type: number
          description: Total number of elements across all pages
        totalPages:
          type: integer
          description: Total number of pages
        size:
          type: integer
          description: Number of elements per page
        number:
          type: integer
          description: Current page number (0-based)
        first:
          type: boolean
          description: Whether this is the first page
        last:
          type: boolean
          description: Whether this is the last page
        numberOfElements:
          type: integer
          description: Number of elements in current page

    # ========================================
    # EXISTING SCHEMAS
    # ========================================

    User:
      type: object
      required:
        - id
        - username
        - firstName
        - lastName
        - email
        - isEmailVerified
        - disabled
        - type
        - streetAddress
        - city
        - postalCode
        - country
      properties:
        id:
          type: string
          format: uuid
        disabled:
          type: boolean
        isEmailVerified:
          type: boolean
        username:
          type: string
        avatarUrl:
          type: string
        phoneNumber:
          type: string
        firstName:
          type: string
        lastName:
          type: string
        email:
          type: string
        flatNumber:
          type: string
          example: A701
        roles:
          type: array
          items:
            type: string
            example: "admin"
        streetAddress:
          type: string
        city:
          type: string
        postalCode:
          type: string
        country:
          type: string
        preferredLanguage:
          type: string
          example: "en"
        profileSharingConsent:
          type: boolean
          description: "User consent for sharing profile information in the community directory"
          default: false
        createdAt:
          type: string
          format: date-time
          description: "User registration date"
        type:
          $ref: "#/components/schemas/UserType"
        primaryUnitId:
          type: string
          format: uuid
          description: "ID of the user's primary unit (for reservations)"

    UserBasic:
      type: object
      required:
        - id
        - firstName
        - lastName
        - email
      description: "Basic user information for hub directory (privacy-friendly)"
      properties:
        id:
          type: string
          format: uuid
        firstName:
          type: string
        lastName:
          type: string
        email:
          type: string

    UserType:
      type: string
      enum:
        - ADMIN
        - OWNER
        - LANDLORD
        - TENANT
        - SYNDIC
        - EXTERNAL
        - CONTRACTOR
        - COMMERCIAL_PROPERTY_OWNER
        - GUEST
        - PROPERTY_MANAGEMENT
      example: "OWNER"

    UnitType:
      type: string
      enum:
        - FLAT
        - GARAGE
        - PARKING
        - COMMERCIAL
        - OTHER
      example: "FLAT"

    UnitMemberResidenceRole:
      type: string
      enum:
        - PROPRIETAIRE
        - BAILLEUR
        - MANAGER
        - TENANT
      example: "PROPRIETAIRE"

    Unit:
      type: object
      required:
        - id
        - name
        - createdAt
        - updatedAt
        - members
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        type:
          $ref: "#/components/schemas/UnitType"
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        members:
          type: array
          items:
            $ref: "#/components/schemas/UnitMember"

    UnitMember:
      type: object
      required:
        - userId
        - user
        - role
        - residenceRole
        - joinedAt
      properties:
        userId:
          type: string
          format: uuid
        user:
          $ref: "#/components/schemas/User"
        role:
          type: string
          enum:
            - ADMIN
            - MEMBER
        residenceRole:
          $ref: "#/components/schemas/UnitMemberResidenceRole"
        joinedAt:
          type: string
          format: date-time

    UnitInvitation:
      type: object
      required:
        - id
        - unitId
        - invitedBy
        - status
        - createdAt
      properties:
        id:
          type: string
          format: uuid
        unitId:
          type: string
          format: uuid
        invitedUserId:
          type: string
          format: uuid
          nullable: true
        invitedEmail:
          type: string
          nullable: true
        invitedBy:
          type: string
          format: uuid
        status:
          type: string
          enum:
            - PENDING
            - ACCEPTED
            - REJECTED
        createdAt:
          type: string
          format: date-time
        respondedAt:
          type: string
          format: date-time
          nullable: true

    UnitJoinRequestStatus:
      type: string
      enum:
        - PENDING
        - APPROVED
        - REJECTED
      example: "PENDING"

    UnitJoinRequest:
      type: object
      required:
        - id
        - unitId
        - requestedById
        - status
        - createdAt
      properties:
        id:
          type: string
          format: uuid
        unitId:
          type: string
          format: uuid
        unit:
          $ref: "#/components/schemas/Unit"
        requestedById:
          type: string
          format: uuid
        requestedBy:
          $ref: "#/components/schemas/User"
        status:
          $ref: "#/components/schemas/UnitJoinRequestStatus"
        message:
          type: string
        createdAt:
          type: string
          format: date-time
        respondedAt:
          type: string
          format: date-time
        respondedById:
          type: string
          format: uuid
        respondedBy:
          $ref: "#/components/schemas/User"

    CreateJoinRequestRequest:
      type: object
      properties:
        message:
          type: string
          description: Optional message to include with the join request

    UnitRequest:
      type: object
      required:
        - name
      properties:
        name:
          type: string
        type:
          $ref: "#/components/schemas/UnitType"
        initialAdminId:
          type: string
          format: uuid

    InviteUserRequest:
      type: object
      properties:
        userId:
          type: string
          format: uuid
        email:
          type: string

    UpdateMemberResidenceRoleRequest:
      type: object
      required:
        - residenceRole
      properties:
        residenceRole:
          $ref: "#/components/schemas/UnitMemberResidenceRole"

    PaginatedUnits:
      type: object
      required:
        - content
        - totalElements
        - totalPages
        - number
        - size
        - first
        - last
        - numberOfElements
      properties:
        content:
          type: array
          items:
            $ref: "#/components/schemas/Unit"
        totalElements:
          type: integer
        totalPages:
          type: integer
        number:
          type: integer
        size:
          type: integer
        first:
          type: boolean
        last:
          type: boolean
        numberOfElements:
          type: integer

    Location:
      type: object
      required:
        - name
        - address
        - coordinates
      properties:
        name:
          type: string
        address:
          type: string
        coordinates:
          type: object
          properties:
            lat:
              type: number
            lng:
              type: number

    CodedError:
      type: object
      required:
        - code
        - message
      properties:
        code:
          type: string
          description: A unique error code that identifies the type of error
          example: AUTH001
        message:
          type: string
          description: A human-readable error message
          example: The specified user could not be found
        traceId:
          type: string
          description: A unique identifier for tracing this error instance
          example: 550e8400-e29b-41d4-a716-446655440000
        documentationUrl:
          type: string
          description: URL to the documentation about this error
          example: https://docs.portal.neohoods.com/errors/AUTH001
        variables:
          type: object
          additionalProperties: true
          description: Additional context variables for the error
          example:
            field: "email"
            value: "invalid@email"

    ValidationFieldError:
      type: object
      required:
        - field
        - message
      properties:
        field:
          type: string
          description: The field that failed validation
          example: email
        message:
          type: string
          description: The validation error message
          example: must be a valid email

    DigitalLock:
      type: object
      required:
        - id
        - name
        - type
        - status
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
          example: "Entre principale"
        type:
          $ref: "#/components/schemas/DigitalLockType"
        status:
          $ref: "#/components/schemas/DigitalLockStatus"
        ttlockConfig:
          $ref: "#/components/schemas/TtlockConfig"
        nukiConfig:
          $ref: "#/components/schemas/NukiConfig"
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    TtlockConfig:
      type: object
      properties:
        id:
          type: string
          format: uuid
        deviceId:
          type: string
          example: "ttlock-001"
        location:
          type: string
          example: "Entre principale"
        batteryLevel:
          type: integer
          example: 85
        signalStrength:
          type: integer
          example: -45
        lastSeen:
          type: string
          format: date-time

    NukiConfig:
      type: object
      properties:
        id:
          type: string
          format: uuid
        deviceId:
          type: string
          example: "nuki-001"
        token:
          type: string
          example: "nuki-token-789"
        batteryLevel:
          type: integer
          example: 95
        lastSeen:
          type: string
          format: date-time

    DigitalLockType:
      type: string
      enum:
        - TTLOCK
        - NUKI
        - YALE
      example: "TTLOCK"

    DigitalLockStatus:
      type: string
      enum:
        - ACTIVE
        - INACTIVE
        - ERROR
      example: "ACTIVE"

    ValidationError:
      allOf:
        - $ref: "#/components/schemas/CodedError"
        - type: object
          properties:
            variables:
              type: object
              required:
                - fields
              properties:
                fields:
                  type: array
                  items:
                    $ref: "#/components/schemas/ValidationFieldError"

    NotificationSettings:
      type: object
      properties:
        enableNotifications:
          type: boolean
          description: Whether notifications are enabled for the user
        newsletterEnabled:
          type: boolean
          description: Whether the user accepts to receive newsletters
          default: true
        calendarUrl:
          type: string
          format: uri
          readOnly: true
          description: URL to user's personal reservation calendar (iCalendar format)
      required:
        - enableNotifications
        - newsletterEnabled

    HelpCategory:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
        icon:
          type: string
        order:
          type: integer
          description: The order of the help category

    HelpArticle:
      type: object
      properties:
        id:
          type: string
          format: uuid
        title:
          type: string
        content:
          type: string
        category:
          $ref: "#/components/schemas/HelpCategory"
        order:
          type: integer
          description: The order of the help article

    CustomPage:
      type: object
      required:
        - id
        - ref
        - position
        - title
        - content
      properties:
        id:
          type: string
          format: uuid
        ref:
          type: string
        order:
          type: integer
        position:
          type: string
          enum: ["footer-links", "copyright", "footer-help"]
        title:
          type: string
        content:
          type: string

    Announcement:
      type: object
      required:
        - id
        - title
        - content
        - createdAt
        - updatedAt
        - category
      properties:
        id:
          type: string
          format: uuid
        title:
          type: string
          example: "New Announcement"
        content:
          type: string
          example: "This is the content of the announcement."
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        category:
          $ref: "#/components/schemas/AnnouncementCategory"

    AnnouncementCategory:
      type: string
      enum:
        - CommunityEvent
        - LostAndFound
        - SafetyAlert
        - MaintenanceNotice
        - SocialGathering
        - Other
      example: "CommunityEvent"

    PaginatedAnnouncementsResponse:
      type: object
      required:
        - totalPages
        - totalItems
        - currentPage
        - itemsPerPage
        - announcements
      properties:
        totalPages:
          type: integer
          example: 10
        totalItems:
          type: integer
          example: 100
        currentPage:
          type: integer
          example: 1
        itemsPerPage:
          type: integer
          example: 10
        announcements:
          type: array
          items:
            $ref: "#/components/schemas/Announcement"

    Notification:
      type: object
      required:
        - id
        - author
        - date
        - type
        - alreadyRead
      properties:
        id:
          type: string
          format: uuid
        author:
          type: string
          example: "system"
        date:
          type: string
          format: date-time
          example: "2023-11-15T13:45:30"
        type:
          type: string
          enum:
            - ADMIN_NEW_USER
            - NEW_ANNOUNCEMENT
            - RESERVATION
            - UNIT_INVITATION
            - UNIT_JOIN_REQUEST
        alreadyRead:
          type: boolean
          example: false
        payload:
          type: object
          additionalProperties: true

    Info:
      type: object
      required:
        - id
        - nextAGDate
        - rulesUrl
        - delegates
        - contactNumbers
      properties:
        id:
          type: string
          format: uuid
        nextAGDate:
          type: string
          format: date-time
        rulesUrl:
          type: string
        delegates:
          type: array
          items:
            $ref: "#/components/schemas/Delegate"
        contactNumbers:
          type: array
          items:
            $ref: "#/components/schemas/ContactNumber"

    Delegate:
      type: object
      properties:
        building:
          type: string
        firstName:
          type: string
        lastName:
          type: string
        email:
          type: string
        matrixUser:
          type: string

    ContactNumber:
      type: object
      properties:
        contactType:
          type: string
          enum: ["syndic", "emergency", "maintenance"]
        type:
          type: string
        description:
          type: string
        availability:
          type: string
          example: "24/7"
        responseTime:
          type: string
          example: "5-10 minutes"
        name:
          type: string
        phoneNumber:
          type: string
        email:
          type: string
        officeHours:
          type: string
          example: "Mon-Fri 9am-5pm"
        address:
          type: string
          example: "123 Main St, Neighborhood City"

    Application:
      type: object
      required:
        - id
        - name
        - url
        - icon
        - helpText
      properties:
        id:
          type: string
          format: uuid
        disabled:
          type: boolean
          default: false
        name:
          type: string
        url:
          type: string
        icon:
          type: string
        helpText:
          type: string

    Newsletter:
      type: object
      required:
        - id
        - subject
        - content
        - audience
        - status
        - createdAt
        - updatedAt
      properties:
        id:
          type: string
          format: uuid
        subject:
          type: string
          example: "Your Monthly Community Newsletter - January 2024"
          description: "Newsletter title and email subject line"
        content:
          type: string
          example: "<h1>Welcome to our monthly newsletter</h1><p>Here are the latest updates...</p>"
          description: "HTML content of the newsletter"
        audience:
          $ref: "#/components/schemas/NewsletterAudience"
        status:
          $ref: "#/components/schemas/NewsletterStatus"
        scheduledAt:
          type: string
          format: date-time
          example: "2024-01-15T10:00:00Z"
          description: "When the newsletter is scheduled to be sent"
        sentAt:
          type: string
          format: date-time
          example: "2024-01-15T10:05:00Z"
          description: "When the newsletter was actually sent"
        createdAt:
          type: string
          format: date-time
          example: "2024-01-10T14:30:00Z"
        updatedAt:
          type: string
          format: date-time
          example: "2024-01-12T09:15:00Z"
        createdBy:
          type: string
          format: uuid
          description: "ID of the admin user who created the newsletter"
        recipientCount:
          type: integer
          example: 150
          description: "Number of recipients when sent"
        openCount:
          type: integer
          example: 95
          description: "Number of times the newsletter was opened"
        clickCount:
          type: integer
          example: 23
          description: "Number of clicks in the newsletter"

    NewsletterRequest:
      type: object
      required:
        - subject
        - content
        - audience
      properties:
        subject:
          type: string
          example: "Your Monthly Community Newsletter - January 2024"
        content:
          type: string
          example: "<h1>Welcome to our monthly newsletter</h1><p>Here are the latest updates...</p>"
        audience:
          $ref: "#/components/schemas/NewsletterAudience"
        scheduledAt:
          type: string
          format: date-time
          example: "2024-01-15T10:00:00Z"
          description: "Optional: Schedule the newsletter for later sending"

    NewsletterAudience:
      type: object
      required:
        - type
      properties:
        type:
          type: string
          enum: ["ALL", "USER_TYPES", "SPECIFIC_USERS"]
          example: "USER_TYPES"
          description: "Type of audience selection"
        userTypes:
          type: array
          items:
            $ref: "#/components/schemas/UserType"
          example: ["OWNER", "TENANT"]
          description: "Required when type is USER_TYPES"
        userIds:
          type: array
          items:
            type: string
            format: uuid
          example:
            [
              "123e4567-e89b-12d3-a456-426614174000",
              "987fcdeb-51a2-43d1-9f83-123456789abc",
            ]
          description: "Required when type is SPECIFIC_USERS"
        excludeUserIds:
          type: array
          items:
            type: string
            format: uuid
          example: ["456e7890-e89b-12d3-a456-426614174000"]
          description: "Optional: Users to exclude from the audience"

    NewsletterStatus:
      type: string
      enum:
        - DRAFT
        - SCHEDULED
        - SENDING
        - SENT
        - CANCELLED
        - FAILED
      example: "DRAFT"
      description: |
        Newsletter status:
        - DRAFT: Newsletter is being created/edited
        - SCHEDULED: Newsletter is scheduled for future sending
        - SENDING: Newsletter is currently being sent
        - SENT: Newsletter has been successfully sent
        - CANCELLED: Scheduled newsletter was cancelled
        - FAILED: Newsletter sending failed

    PaginatedNewslettersResponse:
      type: object
      required:
        - totalPages
        - totalItems
        - currentPage
        - itemsPerPage
        - newsletters
      properties:
        totalPages:
          type: integer
          example: 5
        totalItems:
          type: integer
          example: 42
        currentPage:
          type: integer
          example: 1
        itemsPerPage:
          type: integer
          example: 10
        newsletters:
          type: array
          items:
            $ref: "#/components/schemas/Newsletter"

    NewsletterLogEntry:
      type: object
      required:
        - id
        - newsletterId
        - timestamp
        - level
        - message
      properties:
        id:
          type: string
          format: uuid
        newsletterId:
          type: string
          format: uuid
        timestamp:
          type: string
          format: date-time
          example: "2024-01-15T10:05:30Z"
        level:
          type: string
          enum: ["INFO", "WARN", "ERROR"]
          example: "INFO"
        message:
          type: string
          example: "Newsletter sent successfully to user@example.com"
        details:
          type: string
          nullable: true
          example: "SMTP response: 250 OK"
          description: "Additional details or error information"

    NewsletterLogsResponse:
      type: object
      required:
        - totalPages
        - totalItems
        - currentPage
        - itemsPerPage
        - logs
        - summary
      properties:
        totalPages:
          type: integer
          example: 3
        totalItems:
          type: integer
          example: 247
        currentPage:
          type: integer
          example: 1
        itemsPerPage:
          type: integer
          example: 100
        logs:
          type: array
          items:
            $ref: "#/components/schemas/NewsletterLogEntry"
        summary:
          type: object
          properties:
            totalSent:
              type: integer
              example: 150
            totalFailed:
              type: integer
              example: 5
            successRate:
              type: number
              format: float
              example: 96.77
          description: "Simple summary of the newsletter sending"

    EmailTemplate:
      type: object
      required:
        - id
        - type
        - name
        - subject
        - content
        - isActive
        - createdAt
        - updatedAt
        - createdBy
      properties:
        id:
          type: string
          format: uuid
          description: "Unique identifier for the email template"
        type:
          $ref: "#/components/schemas/EmailTemplateType"
        name:
          type: string
          example: "Welcome Email - Default"
          description: "Display name for the template in admin interface"
        subject:
          type: string
          example: "Welcome to {{appName}}!"
          description: "Email subject line with template variables"
        content:
          type: string
          example: "<h1>Welcome {{username}}!</h1><p>Thank you for joining {{appName}}...</p>"
          description: "HTML content of the email with template variables"
        isActive:
          type: boolean
          example: true
          description: "Whether this template is currently active (only one per type can be active)"
        createdAt:
          type: string
          format: date-time
          example: "2024-01-10T14:30:00Z"
        updatedAt:
          type: string
          format: date-time
          example: "2024-01-12T09:15:00Z"
        createdBy:
          type: string
          format: uuid
          description: "ID of the admin user who created the template"
        description:
          type: string
          example: "Default welcome email sent to new users after registration"
          description: "Optional description of the template's purpose"

    EmailTemplateRequest:
      type: object
      required:
        - type
        - name
        - subject
        - content
      properties:
        type:
          $ref: "#/components/schemas/EmailTemplateType"
        name:
          type: string
          example: "Welcome Email - Custom"
          description: "Display name for the template in admin interface"
        subject:
          type: string
          example: "Welcome to {{appName}}!"
          description: "Email subject line with template variables"
        content:
          type: string
          example: "<h1>Welcome {{username}}!</h1><p>Thank you for joining {{appName}}...</p>"
          description: "HTML content of the email with template variables"
        description:
          type: string
          example: "Custom welcome email with company branding"
          description: "Optional description of the template's purpose"
        isActive:
          type: boolean
          example: false
          description: "Whether to activate this template (deactivates others of same type)"

    EmailTemplateType:
      type: string
      enum:
        - WELCOME
      example: "WELCOME"
      description: |
        Email template types (currently only WELCOME is supported):
        - WELCOME: Welcome email sent to new users after registration

    SignUp201Response:
      type: object
      required:
        - user
        - emailAlreadyVerified
        - message
      properties:
        user:
          $ref: "#/components/schemas/User"
        emailAlreadyVerified:
          type: boolean
          description: "True if the user already existed and email was already verified"
        message:
          type: string
          description: "Success message"

    SpaceImage:
      type: object
      properties:
        id:
          type: string
          format: uuid
        spaceId:
          type: string
          format: uuid
        url:
          type: string
          format: uri
          description: External image URL (optional)
        mimeType:
          type: string
          description: MIME type for images stored in database
        fileName:
          type: string
          description: Original filename
        fileSize:
          type: integer
          description: File size in bytes
        altText:
          type: string
          description: Alt text for accessibility
        isPrimary:
          type: boolean
          description: Whether this is the primary image
        orderIndex:
          type: integer
          description: Display order
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time

    ImageMetadata:
      type: object
      properties:
        id:
          type: string
          format: uuid
        altText:
          type: string
        isPrimary:
          type: boolean
        orderIndex:
          type: integer
        fileName:
          type: string
        fileSize:
          type: integer
        mimeType:
          type: string
        storedInDatabase:
          type: boolean
        externalUrl:
          type: boolean
        url:
          type: string

    GetMatrixBotDeviceCode200Response:
      type: object
      required:
        - deviceCode
        - userCode
        - verificationUri
        - verificationUriComplete
        - expiresIn
        - interval
      properties:
        deviceCode:
          type: string
          description: Device code for polling
        userCode:
          type: string
          description: User code to display
        verificationUri:
          type: string
          format: uri
          description: Verification URI to open
        verificationUriComplete:
          type: string
          format: uri
          description: Complete verification URI with user code
        expiresIn:
          type: integer
          description: Expiration time in seconds
        interval:
          type: integer
          description: Polling interval in seconds

    PollMatrixBotDeviceCodeRequest:
      type: object
      required:
        - deviceCode
      properties:
        deviceCode:
          type: string
          description: Device code to poll

    PollMatrixBotDeviceCode200Response:
      type: object
      required:
        - status
      properties:
        status:
          type: string
          enum: ["pending", "success", "error"]
          description: Polling status
        message:
          type: string
          description: Status message
        accessToken:
          type: string
          description: Access token if status is success

    InitializeMatrixBot200Response:
      type: object
      required:
        - success
        - message
      properties:
        success:
          type: boolean
          description: Whether initialization was started successfully
        message:
          type: string
          description: Status message

    MatrixBotStatus:
      type: object
      required:
        - enabled
        - disabled
        - matrixAccess
        - hasRefreshToken
        - hasAccessToken
      properties:
        enabled:
          type: boolean
          description: Whether Matrix bot is enabled
        disabled:
          type: boolean
          description: Whether Matrix bot is disabled
        matrixAccess:
          type: string
          enum: ["ok", "ko"]
          description: Matrix access status
        hasRefreshToken:
          type: boolean
          description: Whether refresh token is available
        hasAccessToken:
          type: boolean
          description: Whether access token is available and valid
        spaceId:
          type: string
          description: ID of the managed Matrix space
        currentSpaces:
          type: array
          items:
            type: object
            properties:
              spaceId:
                type: string
              name:
                type: string
          description: List of current Matrix spaces
        error:
          type: string
          description: Error message if any

  responses:
    OK_200_GET_HELLO_WORLD:
      description: OK
      content:
        application/json:
          schema:
            title: responseHelloWorld
            type: object
            required:
              - message
            properties:
              message:
                type: string
                example: "Hello world!"
    OK_200_LOGIN:
      description: Logged in user details
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/User"
            example:
              id: "123e4567-e89b-12d3-a456-426614174000"
              username: "my-login"
              firstName: "John"
              lastName: "Doe"
              email: "john.doe@example.com"
              flatNumber: "A701"
              isEmailVerified: true
              disabled: false
              type: "OWNER"
              properties:
                - type: "APARTMENT"
                  name: "Apartment 3A"
              streetAddress: "123 Main Street"
              city: "Downtown"
              postalCode: "12345"
              country: "USA"
    BadRequest:
      description: Bad Request - The request was invalid or cannot be served
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/CodedError"
          examples:
            validation_error:
              value:
                code: VAL001
                message: Validation failed
                variables:
                  fields:
                    - field: email
                      message: must be a valid email
            invalid_input:
              value:
                code: VAL002
                message: Missing required field
                variables:
                  field: username
    Unauthorized:
      description: Unauthorized - Authentication is required
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/CodedError"
          example:
            code: AUTH001
            message: Authentication required
            documentationUrl: https://docs.portal.neohoods.com/errors/AUTH001
    Forbidden:
      description: Forbidden - No permission to access the resource
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/CodedError"
          example:
            code: AUTH005
            message: You don't have sufficient permissions to perform this action
    NotFound:
      description: Not Found - The requested resource was not found
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/CodedError"
          example:
            code: RES001
            message: The requested resource was not found
    ValidationError:
      description: Validation Error - The request data failed validation
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ValidationError"
          example:
            code: VAL001
            message: Validation failed
            variables:
              fields:
                - field: email
                  message: must be a valid email
                - field: password
                  message: must be at least 8 characters
    InternalServerError:
      description: Internal Server Error - Something went wrong on the server
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/CodedError"
          example:
            code: SYS001
            message: An unexpected error occurred
