üîÑ RESTAURATION COMPL√àTE DE LA DB MATRIX
============================================================

Cette op√©ration va :
  1. Exporter homeserver.yaml et keys de chat.terresdelaya.fr
  2. Faire un dump complet de la DB de chat.terresdelaya.fr
  3. Sauvegarder les tables MAS de chat.neohoods.com
  4. Restaurer la DB compl√®te dans chat.neohoods.com
  5. Restaurer les tables MAS
  6. Mettre √† jour les configs pour chat.neohoods.com

üìã Pods identifi√©s:
  - Old Synapse: chat-matrix-6d84bcb456-hbz8j
  - Old Postgres: chat-postgresql-0
  - New Postgres: neohoods-chat-postgres-0

üìÅ Dossier de backup: ./complete-restore-20251126-190607

1Ô∏è‚É£  Export homeserver.yaml...
‚ö†Ô∏è  Impossible de trouver homeserver.yaml, continuons...
2Ô∏è‚É£  Export des keys...
3Ô∏è‚É£  Dump complet de la DB chat.terresdelaya.fr...
‚úÖ Dump cr√©√©: ./complete-restore-20251126-190607/db-terresdelaya-complete.sql ( 21M)

4Ô∏è‚É£  Sauvegarde des tables MAS de chat.neohoods.com...
‚ö†Ô∏è  Erreur application_services_state
‚ö†Ô∏è  Erreur application_services_txns
‚ö†Ô∏è  Erreur applied_module_schemas
‚úÖ Tables MAS sauvegard√©es

‚ö†Ô∏è  ‚ö†Ô∏è  ‚ö†Ô∏è  ATTENTION ‚ö†Ô∏è  ‚ö†Ô∏è  ‚ö†Ô∏è
Vous √™tes sur le point d'√©craser la DB de chat.neohoods.com
Appuyez sur ENTER pour continuer ou Ctrl+C pour annuler...
5Ô∏è‚É£  Restauration de la DB compl√®te...
   Cr√©ation d'un dump propre (sans CREATE/DROP pour tables MAS)...
   Nettoyage de la DB (sauf tables MAS)...
Defaulted container "postgres" out of: postgres, postgres-ess-updater, postgres-exporter
   Import du dump...
ERROR:  role "matrix" does not exist
ERROR:  function "check_event_stream_ordering" already exists with same argument types
ERROR:  role "matrix" does not exist
ERROR:  function "check_partial_state_events" already exists with same argument types
ERROR:  role "matrix" does not exist
ERROR:  function "delete_read_write_lock_parent" already exists with same argument types
ERROR:  role "matrix" does not exist
ERROR:  function "upsert_read_write_lock_parent" already exists with same argument types
ERROR:  role "matrix" does not exist
ERROR:  relation "access_tokens" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "account_data" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "account_data_sequence" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "account_validity" already exists
ERROR:  role "matrix" does not exist
ERROR:  syntax error at or near "as_id"
ERROR:  role "matrix" does not exist
ERROR:  relation "application_services_txn_id_seq" already exists
ERROR:  role "matrix" does not exist
ERROR:  syntax error at or near "as_id"
ERROR:  role "matrix" does not exist
ERROR:  syntax error at or near "module_name"
ERROR:  role "matrix" does not exist
ERROR:  relation "applied_schema_deltas" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "appservice_room_list" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "appservice_stream_position" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "background_updates" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "blocked_rooms" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "cache_invalidation_stream_by_instance" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "cache_invalidation_stream_seq" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "current_state_delta_stream" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "current_state_events" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "dehydrated_devices" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "delayed_events" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "delayed_events_stream_pos" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "deleted_pushers" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "destination_rooms" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "destinations" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "device_auth_providers" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "device_federation_inbox" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "device_federation_outbox" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "device_inbox" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "device_inbox_sequence" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "device_lists_changes_converted_stream_position" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "device_lists_changes_in_room" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "device_lists_outbound_last_success" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "device_lists_outbound_pokes" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "device_lists_remote_cache" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "device_lists_remote_extremeties" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "device_lists_remote_pending" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "device_lists_remote_resync" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "device_lists_sequence" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "device_lists_stream" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "devices" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "e2e_cross_signing_keys" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "e2e_cross_signing_keys_sequence" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "e2e_cross_signing_signatures" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "e2e_device_keys_json" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "e2e_fallback_keys_json" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "e2e_one_time_keys_json" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "e2e_room_keys" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "e2e_room_keys_versions" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "erased_users" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_auth" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_auth_chain_id" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_auth_chain_links" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_auth_chain_to_calculate" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_auth_chains" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_backward_extremities" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_edges" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_expiry" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_failed_pull_attempts" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_forward_extremities" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_json" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_labels" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_push_actions" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_push_actions_staging" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_push_summary" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_push_summary_last_receipt_stream_id" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_push_summary_stream_ordering" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_relations" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_reports" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_search" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_to_state_groups" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "event_txn_id_device_id" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "events" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "events_backfill_stream_seq" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "events_stream_seq" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "ex_outlier_stream" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "federation_inbound_events_staging" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "federation_stream_position" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "ignored_users" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "instance_map" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "instance_map_instance_id_seq" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "local_current_membership" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "local_media_repository" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "local_media_repository_thumbnails" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "local_media_repository_url_cache" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "login_tokens" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "monthly_active_users" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "open_id_tokens" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "partial_state_events" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "partial_state_rooms" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "partial_state_rooms_servers" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "per_user_experimental_features" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "presence_stream" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "presence_stream_sequence" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "profiles" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "push_rules" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "push_rules_enable" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "push_rules_stream" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "push_rules_stream_sequence" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "pusher_throttle" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "pushers" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "pushers_sequence" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "ratelimit_override" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "receipts_graph" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "receipts_linearized" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "receipts_sequence" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "received_transactions" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "redactions" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "refresh_tokens" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "registration_tokens" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "rejections" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "remote_media_cache" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "remote_media_cache_thumbnails" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "room_account_data" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "room_alias_servers" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "room_aliases" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "room_ban_redactions" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "room_depth" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "room_forgetter_stream_pos" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "room_memberships" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "room_reports" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "room_retention" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "room_stats_current" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "room_stats_earliest_token" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "room_stats_state" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "room_tags" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "room_tags_revisions" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "rooms" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "scheduled_tasks" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "schema_compat_version" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "schema_version" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "server_keys_json" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "server_signature_keys" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "sessions" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "sliding_sync_connection_positions" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "sliding_sync_connection_positions_connection_position_seq" already exists
ERROR:  relation "sliding_sync_connection_required_state" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "sliding_sync_connection_required_state_required_state_id_seq" already exists
ERROR:  relation "sliding_sync_connection_room_configs" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "sliding_sync_connection_streams" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "sliding_sync_connections" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "sliding_sync_connections_connection_key_seq" already exists
ERROR:  relation "sliding_sync_joined_rooms" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "sliding_sync_joined_rooms_to_recalculate" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "sliding_sync_membership_snapshots" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "state_events" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "state_group_edges" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "state_group_id_seq" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "state_groups" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "state_groups_pending_deletion" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "state_groups_pending_deletion_sequence_number_seq" already exists
ERROR:  relation "state_groups_persisting" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "state_groups_state" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "stats_incremental_position" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "stream_ordering_to_exterm" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "stream_positions" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "thread_subscriptions" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "thread_subscriptions_sequence" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "threads" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "threepid_guest_access_tokens" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "threepid_validation_session" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "threepid_validation_token" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "timeline_gaps" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "ui_auth_sessions" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "ui_auth_sessions_credentials" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "ui_auth_sessions_ips" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "un_partial_stated_event_stream" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "un_partial_stated_event_stream_sequence" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "un_partial_stated_room_stream" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "un_partial_stated_room_stream_sequence" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "user_daily_visits" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "user_directory" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "user_directory_search" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "user_directory_stale_remote_users" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "user_directory_stream_pos" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "user_external_ids" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "user_filters" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "user_id_seq" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "user_ips" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "user_reports" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "user_signature_stream" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "user_stats_current" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "user_threepid_id_server" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "user_threepids" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "users" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "users_in_public_rooms" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "users_pending_deactivation" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "users_to_send_full_presence_to" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "users_who_share_private_rooms" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "worker_locks" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "worker_read_write_locks" already exists
ERROR:  role "matrix" does not exist
ERROR:  relation "worker_read_write_locks_mode" already exists
ERROR:  role "matrix" does not exist
ERROR:  duplicate key value violates unique constraint "access_tokens_pkey"
ERROR:  duplicate key value violates unique constraint "account_data_uniqueness"
ERROR:  duplicate key value violates unique constraint "applied_schema_deltas_version_file_key"
ERROR:  duplicate key value violates unique constraint "appservice_stream_position_lock_key"
ERROR:  duplicate key value violates unique constraint "cache_invalidation_stream_by_instance_id"
ERROR:  relation "events" does not exist
ERROR:  duplicate key value violates unique constraint "delayed_events_stream_pos_lock_key"
ERROR:  duplicate key value violates unique constraint "device_lists_changes_converted_stream_position_lock_key"
ERROR:  duplicate key value violates unique constraint "device_lists_changes_in_stream_id"
ERROR:  duplicate key value violates unique constraint "device_uniqueness"
ERROR:  duplicate key value violates unique constraint "e2e_cross_signing_keys_idx"
ERROR:  duplicate key value violates unique constraint "e2e_device_keys_json_uniqueness"
ERROR:  duplicate key value violates unique constraint "e2e_fallback_keys_json_uniqueness"
ERROR:  duplicate key value violates unique constraint "e2e_one_time_keys_json_uniqueness"
ERROR:  duplicate key value violates unique constraint "e2e_room_keys_with_version_idx"
ERROR:  duplicate key value violates unique constraint "e2e_room_keys_versions_idx"
ERROR:  duplicate key value violates unique constraint "erased_users_user"
ERROR:  duplicate key value violates unique constraint "event_auth_chains_pkey"
ERROR:  insert or update on table "event_edges" violates foreign key constraint "event_edges_event_id_fkey"
ERROR:  insert or update on table "event_forward_extremities" violates foreign key constraint "event_forward_extremities_event_id"
ERROR:  duplicate key value violates unique constraint "event_push_summary_unique_index2"
ERROR:  duplicate key value violates unique constraint "event_push_summary_last_receipt_stream_id_lock_key"
ERROR:  duplicate key value violates unique constraint "event_push_summary_stream_ordering_lock_key"
ERROR:  duplicate key value violates unique constraint "event_relations_id"
ERROR:  duplicate key value violates unique constraint "event_search_event_id_idx"
ERROR:  duplicate key value violates unique constraint "event_to_state_groups_event_id_key"
ERROR:  insert or update on table "event_txn_id_device_id" violates foreign key constraint "event_txn_id_device_id_event_id_fkey"
ERROR:  duplicate key value violates unique constraint "events_stream_ordering"
ERROR:  duplicate key value violates unique constraint "federation_stream_position_instance"
ERROR:  relation "events" does not exist
ERROR:  duplicate key value violates unique constraint "local_media_repository_media_id_key"
ERROR:  duplicate key value violates unique constraint "local_media_repository_thumbn_media_id_width_height_method_key"
ERROR:  duplicate key value violates unique constraint "open_id_tokens_pkey"
ERROR:  duplicate key value violates unique constraint "profiles_user_id_key"
ERROR:  duplicate key value violates unique constraint "push_rules_pkey"
ERROR:  duplicate key value violates unique constraint "push_rules_enable_pkey"
ERROR:  duplicate key value violates unique constraint "pushers2_app_id_pushkey_user_name_key"
ERROR:  duplicate key value violates unique constraint "receipts_graph_uniqueness_thread"
ERROR:  duplicate key value violates unique constraint "receipts_linearized_uniqueness_thread"
ERROR:  duplicate key value violates unique constraint "redactions_event_id_key"
ERROR:  duplicate key value violates unique constraint "room_account_data_uniqueness"
ERROR:  duplicate key value violates unique constraint "room_aliases_room_alias_key"
ERROR:  duplicate key value violates unique constraint "room_depth_room_id_key"
ERROR:  duplicate key value violates unique constraint "room_forgetter_stream_pos_lock_key"
ERROR:  relation "events" does not exist
ERROR:  duplicate key value violates unique constraint "room_stats_current_pkey"
ERROR:  duplicate key value violates unique constraint "room_stats_state_room"
ERROR:  duplicate key value violates unique constraint "room_tag_uniqueness"
ERROR:  duplicate key value violates unique constraint "room_tag_revisions_uniqueness"
ERROR:  duplicate key value violates unique constraint "schema_compat_version_lock_key"
ERROR:  duplicate key value violates unique constraint "schema_version_lock_key"
ERROR:  duplicate key value violates unique constraint "server_keys_json_uniqueness"
ERROR:  duplicate key value violates unique constraint "server_signature_keys_server_name_key_id_key"
ERROR:  insert or update on table "sliding_sync_joined_rooms" violates foreign key constraint "sliding_sync_joined_rooms_event_stream_ordering_fkey"
ERROR:  insert or update on table "sliding_sync_membership_snapshots" violates foreign key constraint "sliding_sync_membership_snapshots_membership_event_id_fkey"
ERROR:  duplicate key value violates unique constraint "state_group_edges_unique_idx"
ERROR:  duplicate key value violates unique constraint "state_groups_pkey"
ERROR:  duplicate key value violates unique constraint "stats_incremental_position_lock_key"
ERROR:  duplicate key value violates unique constraint "stream_positions_idx"
ERROR:  duplicate key value violates unique constraint "threads_uniqueness"
ERROR:  duplicate key value violates unique constraint "user_directory_user_idx"
ERROR:  duplicate key value violates unique constraint "user_directory_search_user_idx"
ERROR:  duplicate key value violates unique constraint "user_directory_stream_pos_lock_key"
ERROR:  duplicate key value violates unique constraint "user_external_ids_auth_provider_external_id_key"
ERROR:  duplicate key value violates unique constraint "user_filters_unique"
ERROR:  duplicate key value violates unique constraint "user_ips_user_token_ip_unique_index"
ERROR:  duplicate key value violates unique constraint "user_signature_stream_idx"
ERROR:  duplicate key value violates unique constraint "user_stats_current_pkey"
ERROR:  duplicate key value violates unique constraint "medium_address"
ERROR:  duplicate key value violates unique constraint "users_in_public_rooms_u_idx"
ERROR:  duplicate key value violates unique constraint "users_who_share_private_rooms_u_idx"
ERROR:  multiple primary keys for table "access_tokens" are not allowed
ERROR:  relation "access_tokens_token_key" already exists
ERROR:  relation "account_data_uniqueness" already exists
ERROR:  multiple primary keys for table "account_validity" are not allowed
ERROR:  multiple primary keys for table "application_services_state" are not allowed
ERROR:  relation "application_services_txns_as_id_txn_id_key" already exists
ERROR:  relation "applied_module_schemas_module_name_file_key" already exists
ERROR:  relation "applied_schema_deltas_version_file_key" already exists
ERROR:  relation "appservice_stream_position_lock_key" already exists
ERROR:  relation "background_updates_uniqueness" already exists
ERROR:  relation "current_state_events_event_id_key" already exists
ERROR:  relation "current_state_events_room_id_type_state_key_key" already exists
ERROR:  multiple primary keys for table "dehydrated_devices" are not allowed
ERROR:  multiple primary keys for table "delayed_events" are not allowed
ERROR:  relation "delayed_events_stream_pos_lock_key" already exists
ERROR:  multiple primary keys for table "destination_rooms" are not allowed
ERROR:  multiple primary keys for table "destinations" are not allowed
ERROR:  relation "device_lists_changes_converted_stream_position_lock_key" already exists
ERROR:  multiple primary keys for table "device_lists_remote_pending" are not allowed
ERROR:  relation "device_uniqueness" already exists
ERROR:  relation "e2e_device_keys_json_uniqueness" already exists
ERROR:  relation "e2e_fallback_keys_json_uniqueness" already exists
ERROR:  relation "e2e_one_time_keys_json_uniqueness" already exists
ERROR:  multiple primary keys for table "event_auth_chain_to_calculate" are not allowed
ERROR:  multiple primary keys for table "event_auth_chains" are not allowed
ERROR:  relation "event_backward_extremities_event_id_room_id_key" already exists
ERROR:  multiple primary keys for table "event_expiry" are not allowed
ERROR:  multiple primary keys for table "event_failed_pull_attempts" are not allowed
ERROR:  relation "event_forward_extremities_event_id_room_id_key" already exists
ERROR:  relation "event_id_user_id_profile_tag_uniqueness" already exists
ERROR:  relation "event_json_event_id_key" already exists
ERROR:  multiple primary keys for table "event_labels" are not allowed
ERROR:  relation "event_push_summary_last_receipt_stream_id_lock_key" already exists
ERROR:  relation "event_push_summary_stream_ordering_lock_key" already exists
ERROR:  multiple primary keys for table "event_reports" are not allowed
ERROR:  relation "event_to_state_groups_event_id_key" already exists
ERROR:  relation "events_event_id_key" already exists
ERROR:  multiple primary keys for table "ex_outlier_stream" are not allowed
ERROR:  multiple primary keys for table "instance_map" are not allowed
ERROR:  relation "local_media_repository_media_id_key" already exists
ERROR:  multiple primary keys for table "login_tokens" are not allowed
ERROR:  relation "medium_address" already exists
ERROR:  multiple primary keys for table "open_id_tokens" are not allowed
ERROR:  relation "partial_state_events_event_id_key" already exists
ERROR:  multiple primary keys for table "partial_state_rooms" are not allowed
ERROR:  relation "partial_state_rooms_servers_room_id_server_name_key" already exists
ERROR:  multiple primary keys for table "per_user_experimental_features" are not allowed
ERROR:  relation "profiles_user_id_key" already exists
ERROR:  multiple primary keys for table "push_rules_enable" are not allowed
ERROR:  relation "push_rules_enable_user_name_rule_id_key" already exists
ERROR:  multiple primary keys for table "push_rules" are not allowed
ERROR:  relation "push_rules_user_name_rule_id_key" already exists
ERROR:  multiple primary keys for table "pusher_throttle" are not allowed
ERROR:  relation "pushers2_app_id_pushkey_user_name_key" already exists
ERROR:  multiple primary keys for table "pushers" are not allowed
ERROR:  relation "receipts_graph_uniqueness_thread" already exists
ERROR:  relation "receipts_linearized_uniqueness_thread" already exists
ERROR:  relation "received_transactions_transaction_id_origin_key" already exists
ERROR:  relation "redactions_event_id_key" already exists
ERROR:  multiple primary keys for table "refresh_tokens" are not allowed
ERROR:  relation "refresh_tokens_token_key" already exists
ERROR:  relation "registration_tokens_token_key" already exists
ERROR:  relation "rejections_event_id_key" already exists
ERROR:  relation "remote_media_cache_media_origin_media_id_key" already exists
ERROR:  relation "room_account_data_uniqueness" already exists
ERROR:  relation "room_aliases_room_alias_key" already exists
ERROR:  relation "room_ban_redaction_uniqueness" already exists
ERROR:  relation "room_depth_room_id_key" already exists
ERROR:  relation "room_forgetter_stream_pos_lock_key" already exists
ERROR:  relation "room_memberships_event_id_key" already exists
ERROR:  multiple primary keys for table "room_reports" are not allowed
ERROR:  multiple primary keys for table "room_retention" are not allowed
ERROR:  multiple primary keys for table "room_stats_current" are not allowed
ERROR:  relation "room_tag_revisions_uniqueness" already exists
ERROR:  relation "room_tag_uniqueness" already exists
ERROR:  multiple primary keys for table "rooms" are not allowed
ERROR:  multiple primary keys for table "scheduled_tasks" are not allowed
ERROR:  relation "schema_compat_version_lock_key" already exists
ERROR:  relation "schema_version_lock_key" already exists
ERROR:  relation "server_keys_json_uniqueness" already exists
ERROR:  relation "server_signature_keys_server_name_key_id_key" already exists
ERROR:  relation "sessions_session_type_session_id_key" already exists
ERROR:  multiple primary keys for table "sliding_sync_connection_positions" are not allowed
ERROR:  multiple primary keys for table "sliding_sync_connection_required_state" are not allowed
ERROR:  multiple primary keys for table "sliding_sync_connections" are not allowed
ERROR:  multiple primary keys for table "sliding_sync_joined_rooms" are not allowed
ERROR:  multiple primary keys for table "sliding_sync_joined_rooms_to_recalculate" are not allowed
ERROR:  multiple primary keys for table "sliding_sync_membership_snapshots" are not allowed
ERROR:  relation "state_events_event_id_key" already exists
ERROR:  multiple primary keys for table "state_groups_pending_deletion" are not allowed
ERROR:  multiple primary keys for table "state_groups_persisting" are not allowed
ERROR:  multiple primary keys for table "state_groups" are not allowed
ERROR:  relation "stats_incremental_position_lock_key" already exists
ERROR:  multiple primary keys for table "thread_subscriptions" are not allowed
ERROR:  relation "thread_subscriptions_room_id_event_id_user_id_key" already exists
ERROR:  relation "threads_uniqueness" already exists
ERROR:  multiple primary keys for table "threepid_validation_session" are not allowed
ERROR:  multiple primary keys for table "threepid_validation_token" are not allowed
ERROR:  relation "ui_auth_sessions_credentials_session_id_stage_type_key" already exists
ERROR:  relation "ui_auth_sessions_ips_session_id_ip_user_agent_key" already exists
ERROR:  relation "ui_auth_sessions_session_id_key" already exists
ERROR:  multiple primary keys for table "un_partial_stated_event_stream" are not allowed
ERROR:  multiple primary keys for table "un_partial_stated_room_stream" are not allowed
ERROR:  multiple primary keys for table "user_directory_stale_remote_users" are not allowed
ERROR:  relation "user_directory_stream_pos_lock_key" already exists
ERROR:  relation "user_external_ids_auth_provider_external_id_key" already exists
ERROR:  multiple primary keys for table "user_reports" are not allowed
ERROR:  multiple primary keys for table "user_stats_current" are not allowed
ERROR:  relation "users_name_key" already exists
ERROR:  multiple primary keys for table "users_to_send_full_presence_to" are not allowed
ERROR:  relation "access_tokens_device_id" already exists
ERROR:  relation "access_tokens_refresh_token_id_idx" already exists
ERROR:  relation "account_data_stream_id" already exists
ERROR:  relation "application_services_txns_id" already exists
ERROR:  relation "appservice_room_list_idx" already exists
ERROR:  relation "blocked_rooms_idx" already exists
ERROR:  relation "cache_invalidation_stream_by_instance_id" already exists
ERROR:  relation "cache_invalidation_stream_by_instance_instance_index" already exists
ERROR:  relation "current_state_delta_stream_idx" already exists
ERROR:  relation "current_state_delta_stream_room_idx" already exists
ERROR:  relation "current_state_events_member_index" already exists
ERROR:  relation "current_state_events_members_room_index" already exists
ERROR:  relation "current_state_events_stream_ordering_idx" already exists
ERROR:  relation "delayed_events_is_processed" already exists
ERROR:  relation "delayed_events_room_state_event_idx" already exists
ERROR:  relation "delayed_events_send_ts" already exists
ERROR:  relation "deleted_pushers_stream_id" already exists
ERROR:  relation "destination_rooms_room_id" already exists
ERROR:  relation "device_auth_providers_devices" already exists
ERROR:  relation "device_auth_providers_sessions" already exists
ERROR:  relation "device_federation_inbox_received_ts_index" already exists
ERROR:  relation "device_federation_inbox_sender_id" already exists
ERROR:  relation "device_federation_outbox_destination_id" already exists
ERROR:  relation "device_federation_outbox_id" already exists
ERROR:  relation "device_inbox_stream_id_user_id" already exists
ERROR:  relation "device_inbox_user_stream_id" already exists
ERROR:  relation "device_lists_changes_in_room_by_room_idx" already exists
ERROR:  relation "device_lists_changes_in_stream_id" already exists
ERROR:  relation "device_lists_changes_in_stream_id_unconverted" already exists
ERROR:  relation "device_lists_outbound_last_success_unique_idx" already exists
ERROR:  relation "device_lists_outbound_pokes_id" already exists
ERROR:  relation "device_lists_outbound_pokes_stream" already exists
ERROR:  relation "device_lists_outbound_pokes_user" already exists
ERROR:  relation "device_lists_remote_cache_unique_id" already exists
ERROR:  relation "device_lists_remote_extremeties_unique_idx" already exists
ERROR:  relation "device_lists_remote_pending_user_device_id" already exists
ERROR:  relation "device_lists_remote_resync_idx" already exists
ERROR:  relation "device_lists_remote_resync_ts_idx" already exists
ERROR:  relation "device_lists_stream_id" already exists
ERROR:  relation "device_lists_stream_user_id" already exists
ERROR:  relation "e2e_cross_signing_keys_idx" already exists
ERROR:  relation "e2e_cross_signing_keys_stream_idx" already exists
ERROR:  relation "e2e_cross_signing_signatures2_idx" already exists
ERROR:  relation "e2e_one_time_keys_json_user_id_device_id_algorithm_ts_added_idx" already exists
ERROR:  relation "e2e_room_keys_room_id" already exists
ERROR:  relation "e2e_room_keys_versions_idx" already exists
ERROR:  relation "e2e_room_keys_with_version_idx" already exists
ERROR:  relation "erased_users_user" already exists
ERROR:  relation "ev_b_extrem_id" already exists
ERROR:  relation "ev_b_extrem_room" already exists
ERROR:  relation "ev_edges_prev_id" already exists
ERROR:  relation "ev_extrem_id" already exists
ERROR:  relation "ev_extrem_room" already exists
ERROR:  relation "evauth_edges_id" already exists
ERROR:  relation "event_auth_chain_links_idx" already exists
ERROR:  relation "event_auth_chain_links_origin_index" already exists
ERROR:  relation "event_auth_chain_to_calculate_rm_id" already exists
ERROR:  relation "event_auth_chains_c_seq_index" already exists
ERROR:  relation "event_contains_url_index" already exists
ERROR:  relation "event_edges_event_id_prev_event_id_idx" already exists
ERROR:  relation "event_expiry_expiry_ts_idx" already exists
ERROR:  relation "event_failed_pull_attempts_room_id" already exists
ERROR:  relation "event_labels_room_id_label_idx" already exists
ERROR:  relation "event_push_actions_highlights_index" already exists
ERROR:  relation "event_push_actions_rm_tokens" already exists
ERROR:  relation "event_push_actions_room_id_user_id" already exists
ERROR:  relation "event_push_actions_staging_id" already exists
ERROR:  relation "event_push_actions_stream_highlight_index" already exists
ERROR:  relation "event_push_actions_stream_ordering" already exists
ERROR:  relation "event_push_actions_u_highlight" already exists
ERROR:  relation "event_push_summary_index_room_id" already exists
ERROR:  relation "event_push_summary_unique_index2" already exists
ERROR:  relation "event_relations_id" already exists
ERROR:  relation "event_relations_relates" already exists
ERROR:  relation "event_search_ev_ridx" already exists
ERROR:  relation "event_search_event_id_idx" already exists
ERROR:  relation "event_search_fts_idx" already exists
ERROR:  relation "event_to_state_groups_sg_index" already exists
ERROR:  relation "event_txn_id_device_id_event_id" already exists
ERROR:  relation "event_txn_id_device_id_ts" already exists
ERROR:  relation "event_txn_id_device_id_txn_id2" already exists
ERROR:  relation "events_jump_to_date_idx" already exists
ERROR:  relation "events_order_room" already exists
ERROR:  relation "events_room_stream" already exists
ERROR:  relation "events_stream_ordering" already exists
ERROR:  relation "events_ts" already exists
ERROR:  relation "federation_inbound_events_staging_instance_event" already exists
ERROR:  relation "federation_inbound_events_staging_room" already exists
ERROR:  relation "federation_stream_position_instance" already exists
ERROR:  relation "full_users_unique_idx" already exists
ERROR:  relation "ignored_users_ignored_user_id" already exists
ERROR:  relation "ignored_users_uniqueness" already exists
ERROR:  relation "instance_map_idx" already exists
ERROR:  relation "local_current_membership_idx" already exists
ERROR:  relation "local_current_membership_room_idx" already exists
ERROR:  relation "local_current_membership_stream_ordering_idx" already exists
ERROR:  relation "local_media_repository_sha256" already exists
ERROR:  relation "local_media_repository_thumbn_media_id_width_height_method_key" already exists
ERROR:  relation "local_media_repository_thumbnails_media_id" already exists
ERROR:  relation "local_media_repository_url_cache_by_url_download_ts" already exists
ERROR:  relation "local_media_repository_url_cache_expires_idx" already exists
ERROR:  relation "local_media_repository_url_cache_media_idx" already exists
ERROR:  relation "local_media_repository_url_idx" already exists
ERROR:  relation "login_tokens_auth_provider_idx" already exists
ERROR:  relation "login_tokens_expiry_time_idx" already exists
ERROR:  relation "monthly_active_users_time_stamp" already exists
ERROR:  relation "monthly_active_users_users" already exists
ERROR:  relation "open_id_tokens_ts_valid_until_ms" already exists
ERROR:  relation "partial_state_events_room_id_idx" already exists
ERROR:  relation "presence_stream_id" already exists
ERROR:  relation "presence_stream_state_not_offline_idx" already exists
ERROR:  relation "presence_stream_user_id" already exists
ERROR:  relation "profiles_full_user_id_key" already exists
ERROR:  relation "public_room_index" already exists
ERROR:  relation "push_rules_enable_user_name" already exists
ERROR:  relation "push_rules_stream_id" already exists
ERROR:  relation "push_rules_stream_user_stream_id" already exists
ERROR:  relation "push_rules_user_name" already exists
ERROR:  relation "ratelimit_override_idx" already exists
ERROR:  relation "receipts_graph_unique_index" already exists
ERROR:  relation "receipts_linearized_event_id" already exists
ERROR:  relation "receipts_linearized_id" already exists
ERROR:  relation "receipts_linearized_room_stream" already exists
ERROR:  relation "receipts_linearized_unique_index" already exists
ERROR:  relation "receipts_linearized_user" already exists
ERROR:  relation "received_transactions_ts" already exists
ERROR:  relation "received_ts_idx" already exists
ERROR:  relation "redactions_have_censored_ts" already exists
ERROR:  relation "redactions_redacts" already exists
ERROR:  relation "refresh_tokens_next_token_id" already exists
ERROR:  relation "remote_media_cache_sha256" already exists
ERROR:  relation "remote_media_repository_thumbn_media_origin_id_width_height_met" already exists
ERROR:  relation "room_account_data_room_id" already exists
ERROR:  relation "room_account_data_stream_id" already exists
ERROR:  relation "room_alias_servers_alias" already exists
ERROR:  relation "room_aliases_id" already exists
ERROR:  relation "room_membership_user_room_idx" already exists
ERROR:  relation "room_memberships_room_id" already exists
ERROR:  relation "room_memberships_stream_ordering_idx" already exists
ERROR:  relation "room_memberships_user_id" already exists
ERROR:  relation "room_memberships_user_room_forgotten" already exists
ERROR:  relation "room_retention_max_lifetime_idx" already exists
ERROR:  relation "room_stats_earliest_token_idx" already exists
ERROR:  relation "room_stats_state_room" already exists
ERROR:  relation "scheduled_tasks_status" already exists
ERROR:  relation "scheduled_tasks_timestamp" already exists
ERROR:  relation "sliding_sync_connection_positions_key" already exists
ERROR:  relation "sliding_sync_connection_positions_ts_idx" already exists
ERROR:  relation "sliding_sync_connection_required_state_conn_pos" already exists
ERROR:  relation "sliding_sync_connection_room_configs_idx" already exists
ERROR:  relation "sliding_sync_connection_room_configs_required_state_id_idx" already exists
ERROR:  relation "sliding_sync_connection_streams_idx" already exists
ERROR:  relation "sliding_sync_connections_idx" already exists
ERROR:  relation "sliding_sync_connections_ts_idx" already exists
ERROR:  relation "sliding_sync_joined_rooms_event_stream_ordering" already exists
ERROR:  relation "sliding_sync_membership_snapshots_event_stream_ordering" already exists
ERROR:  relation "sliding_sync_membership_snapshots_membership_event_id_idx" already exists
ERROR:  relation "sliding_sync_membership_snapshots_user_id_stream_ordering" already exists
ERROR:  relation "state_group_edges_prev_idx" already exists
ERROR:  relation "state_group_edges_unique_idx" already exists
ERROR:  relation "state_groups_pending_deletion_insertion_ts" already exists
ERROR:  relation "state_groups_pending_deletion_state_group" already exists
ERROR:  relation "state_groups_persisting_instance_name" already exists
ERROR:  relation "state_groups_room_id_idx" already exists
ERROR:  relation "state_groups_state_type_idx" already exists
ERROR:  relation "stream_ordering_to_exterm_idx" already exists
ERROR:  relation "stream_ordering_to_exterm_rm_idx" already exists
ERROR:  relation "stream_positions_idx" already exists
ERROR:  relation "thread_subscriptions_by_event" already exists
ERROR:  relation "thread_subscriptions_by_user" already exists
ERROR:  relation "thread_subscriptions_user_room" already exists
ERROR:  relation "threads_ordering_idx" already exists
ERROR:  relation "threepid_guest_access_tokens_index" already exists
ERROR:  relation "threepid_validation_token_session_id" already exists
ERROR:  relation "timeline_gaps_room_id" already exists
ERROR:  relation "un_partial_stated_event_stream_room_id" already exists
ERROR:  relation "un_partial_stated_room_stream_room_id" already exists
ERROR:  relation "user_daily_visits_ts_idx" already exists
ERROR:  relation "user_daily_visits_uts_idx" already exists
ERROR:  relation "user_directory_room_idx" already exists
ERROR:  relation "user_directory_search_fts_idx" already exists
ERROR:  relation "user_directory_search_user_idx" already exists
ERROR:  relation "user_directory_stale_remote_users_next_try_by_server_idx" already exists
ERROR:  relation "user_directory_stale_remote_users_next_try_idx" already exists
ERROR:  relation "user_directory_user_idx" already exists
ERROR:  relation "user_external_ids_user_id_idx" already exists
ERROR:  relation "user_filters_unique" already exists
ERROR:  relation "user_ips_device_id" already exists
ERROR:  relation "user_ips_last_seen" already exists
ERROR:  relation "user_ips_last_seen_only" already exists
ERROR:  relation "user_ips_user_token_ip_unique_index" already exists
ERROR:  relation "user_reports_target_user_id" already exists
ERROR:  relation "user_reports_user_id" already exists
ERROR:  relation "user_signature_stream_idx" already exists
ERROR:  relation "user_threepid_id_server_idx" already exists
ERROR:  relation "user_threepids_medium_address" already exists
ERROR:  relation "user_threepids_user_id" already exists
ERROR:  relation "users_creation_ts" already exists
ERROR:  relation "users_have_local_media" already exists
ERROR:  relation "users_in_public_rooms_r_idx" already exists
ERROR:  relation "users_in_public_rooms_u_idx" already exists
ERROR:  relation "users_who_share_private_rooms_o_idx" already exists
ERROR:  relation "users_who_share_private_rooms_r_idx" already exists
ERROR:  relation "users_who_share_private_rooms_u_idx" already exists
ERROR:  relation "worker_locks_key" already exists
ERROR:  relation "worker_read_write_locks_key" already exists
ERROR:  relation "worker_read_write_locks_mode_key" already exists
ERROR:  relation "worker_read_write_locks_mode_type" already exists
ERROR:  relation "worker_read_write_locks_write" already exists
ERROR:  trigger "check_event_stream_ordering" for relation "current_state_events" already exists
ERROR:  trigger "check_event_stream_ordering" for relation "local_current_membership" already exists
ERROR:  trigger "check_event_stream_ordering" for relation "room_memberships" already exists
ERROR:  trigger "check_partial_state_events" for relation "partial_state_events" already exists
ERROR:  trigger "delete_read_write_lock_parent_trigger" for relation "worker_read_write_locks" already exists
ERROR:  trigger "upsert_read_write_lock_parent_trigger" for relation "worker_read_write_locks" already exists
ERROR:  constraint "access_tokens_refresh_token_id_fkey" for relation "access_tokens" already exists
ERROR:  constraint "destination_rooms_destination_fkey" for relation "destination_rooms" already exists
ERROR:  constraint "destination_rooms_room_id_fkey" for relation "destination_rooms" already exists
ERROR:  constraint "event_edges_event_id_fkey" for relation "event_edges" already exists
ERROR:  constraint "event_failed_pull_attempts_room_id_fkey" for relation "event_failed_pull_attempts" already exists
ERROR:  constraint "event_forward_extremities_event_id" for relation "event_forward_extremities" already exists
ERROR:  constraint "event_stream_ordering_fkey" for relation "current_state_events" already exists
ERROR:  constraint "event_stream_ordering_fkey" for relation "local_current_membership" already exists
ERROR:  constraint "event_stream_ordering_fkey" for relation "room_memberships" already exists
ERROR:  constraint "event_txn_id_device_id_event_id_fkey" for relation "event_txn_id_device_id" already exists
ERROR:  constraint "event_txn_id_device_id_user_id_device_id_fkey" for relation "event_txn_id_device_id" already exists
ERROR:  constraint "partial_state_events_event_id_fkey" for relation "partial_state_events" already exists
ERROR:  constraint "partial_state_events_room_id_fkey" for relation "partial_state_events" already exists
ERROR:  constraint "partial_state_rooms_join_event_id_fkey" for relation "partial_state_rooms" already exists
ERROR:  constraint "partial_state_rooms_room_id_fkey" for relation "partial_state_rooms" already exists
ERROR:  constraint "partial_state_rooms_servers_room_id_fkey" for relation "partial_state_rooms_servers" already exists
ERROR:  constraint "per_user_experimental_features_user_id_fkey" for relation "per_user_experimental_features" already exists
ERROR:  constraint "refresh_tokens_next_token_id_fkey" for relation "refresh_tokens" already exists
ERROR:  constraint "sliding_sync_connection_positions_connection_key_fkey" for relation "sliding_sync_connection_positions" already exists
ERROR:  constraint "sliding_sync_connection_required_state_connection_key_fkey" for relation "sliding_sync_connection_required_state" already exists
ERROR:  constraint "sliding_sync_connection_room_configs_connection_position_fkey" for relation "sliding_sync_connection_room_configs" already exists
ERROR:  constraint "sliding_sync_connection_room_configs_required_state_id_fkey" for relation "sliding_sync_connection_room_configs" already exists
ERROR:  constraint "sliding_sync_connection_streams_connection_position_fkey" for relation "sliding_sync_connection_streams" already exists
ERROR:  constraint "sliding_sync_joined_rooms_event_stream_ordering_fkey" for relation "sliding_sync_joined_rooms" already exists
ERROR:  constraint "sliding_sync_joined_rooms_room_id_fkey" for relation "sliding_sync_joined_rooms" already exists
ERROR:  constraint "sliding_sync_joined_rooms_to_recalculate_room_id_fkey" for relation "sliding_sync_joined_rooms_to_recalculate" already exists
ERROR:  constraint "sliding_sync_membership_snapshots_event_stream_ordering_fkey" for relation "sliding_sync_membership_snapshots" already exists
ERROR:  constraint "sliding_sync_membership_snapshots_membership_event_id_fkey" for relation "sliding_sync_membership_snapshots" already exists
ERROR:  constraint "sliding_sync_membership_snapshots_room_id_fkey" for relation "sliding_sync_membership_snapshots" already exists
ERROR:  constraint "thread_subscriptions_fk_events" for relation "thread_subscriptions" already exists
ERROR:  constraint "thread_subscriptions_fk_rooms" for relation "thread_subscriptions" already exists
ERROR:  constraint "thread_subscriptions_fk_users" for relation "thread_subscriptions" already exists
ERROR:  constraint "ui_auth_sessions_credentials_session_id_fkey" for relation "ui_auth_sessions_credentials" already exists
ERROR:  constraint "ui_auth_sessions_ips_session_id_fkey" for relation "ui_auth_sessions_ips" already exists
ERROR:  constraint "un_partial_stated_event_stream_event_id_fkey" for relation "un_partial_stated_event_stream" already exists
ERROR:  constraint "un_partial_stated_room_stream_room_id_fkey" for relation "un_partial_stated_room_stream" already exists
ERROR:  constraint "users_to_send_full_presence_to_user_id_fkey" for relation "users_to_send_full_presence_to" already exists
ERROR:  constraint "worker_read_write_locks_lock_name_lock_key_write_lock_fkey" for relation "worker_read_write_locks" already exists
ERROR:  constraint "worker_read_write_locks_mode_foreign" for relation "worker_read_write_locks_mode" already exists
‚úÖ DB restaur√©e

6Ô∏è‚É£  Restauration des tables MAS...
   Restauration application_services_state...
Defaulted container "postgres" out of: postgres, postgres-ess-updater, postgres-exporter
Defaulted container "postgres" out of: postgres, postgres-ess-updater, postgres-exporter
Defaulted container "postgres" out of: postgres, postgres-ess-updater, postgres-exporter
ERROR:  missing data for column "state"
CONTEXT:  COPY application_services_state, line 2: "ERROR:  syntax error at or near "\""
command terminated with exit code 1
‚ö†Ô∏è  Erreur restauration application_services_state
   Restauration application_services_txns...
Defaulted container "postgres" out of: postgres, postgres-ess-updater, postgres-exporter
Defaulted container "postgres" out of: postgres, postgres-ess-updater, postgres-exporter
Defaulted container "postgres" out of: postgres, postgres-ess-updater, postgres-exporter
ERROR:  missing data for column "txn_id"
CONTEXT:  COPY application_services_txns, line 2: "ERROR:  syntax error at or near "\""
command terminated with exit code 1
‚ö†Ô∏è  Erreur restauration application_services_txns
   Restauration applied_module_schemas...
Defaulted container "postgres" out of: postgres, postgres-ess-updater, postgres-exporter
Defaulted container "postgres" out of: postgres, postgres-ess-updater, postgres-exporter
Defaulted container "postgres" out of: postgres, postgres-ess-updater, postgres-exporter
ERROR:  missing data for column "file"
CONTEXT:  COPY applied_module_schemas, line 2: "ERROR:  syntax error at or near "\""
command terminated with exit code 1
‚ö†Ô∏è  Erreur restauration applied_module_schemas
‚úÖ Tables MAS restaur√©es

7Ô∏è‚É£  Mise √† jour des configs pour chat.neohoods.com...
Defaulted container "postgres" out of: postgres, postgres-ess-updater, postgres-exporter
‚úÖ Configs mises √† jour

8Ô∏è‚É£  Red√©marrage de Synapse...
pod "neohoods-chat-synapse-main-0" deleted from neohoods-chat namespace
‚úÖ Synapse red√©marr√©

‚úÖ‚úÖ‚úÖ RESTAURATION TERMIN√âE ‚úÖ‚úÖ‚úÖ

üìÅ Backup sauvegard√© dans: ./complete-restore-20251126-190607

‚ö†Ô∏è  Prochaines √©tapes:
  1. V√©rifier que Synapse d√©marre correctement
  2. V√©rifier les rooms et messages
  3. D√©placer les rooms dans le space !YenniyNVsUoBCLHtZS:chat.neohoods.com

